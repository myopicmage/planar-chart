{"version":3,"file":"chart.js","sources":["../../node_modules/svelte/internal/index.mjs","../../node_modules/svelte/transition/index.mjs","../../src/chart/data.ts","../../node_modules/@microsoft/signalr/dist/esm/Errors.js","../../node_modules/@microsoft/signalr/dist/esm/ILogger.js","../../node_modules/@microsoft/signalr/dist/esm/HttpClient.js","../../node_modules/@microsoft/signalr/dist/esm/Loggers.js","../../node_modules/@microsoft/signalr/dist/esm/Utils.js","../../node_modules/@microsoft/signalr/dist/esm/NodeHttpClient.js","../../node_modules/@microsoft/signalr/dist/esm/IHubProtocol.js","../../node_modules/@microsoft/signalr/dist/esm/XhrHttpClient.js","../../node_modules/@microsoft/signalr/dist/esm/DefaultHttpClient.js","../../node_modules/@microsoft/signalr/dist/esm/TextMessageFormat.js","../../node_modules/@microsoft/signalr/dist/esm/HandshakeProtocol.js","../../node_modules/@microsoft/signalr/dist/esm/Subject.js","../../node_modules/@microsoft/signalr/dist/esm/HubConnection.js","../../node_modules/@microsoft/signalr/dist/esm/ITransport.js","../../node_modules/@microsoft/signalr/dist/esm/DefaultReconnectPolicy.js","../../node_modules/@microsoft/signalr/dist/esm/AbortController.js","../../node_modules/@microsoft/signalr/dist/esm/LongPollingTransport.js","../../node_modules/@microsoft/signalr/dist/esm/ServerSentEventsTransport.js","../../node_modules/@microsoft/signalr/dist/esm/WebSocketTransport.js","../../node_modules/@microsoft/signalr/dist/esm/HttpConnection.js","../../node_modules/@microsoft/signalr/dist/esm/JsonHubProtocol.js","../../node_modules/@microsoft/signalr/dist/esm/HubConnectionBuilder.js","../../src/chart/signalr.ts","../../src/chart/Plane.svelte","../../src/chart/Orbit.svelte","../../src/chart/App.svelte","../../src/chart/chart.ts"],"sourcesContent":["function noop() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\nfunction is_promise(value) {\n    return value && typeof value === 'object' && typeof value.then === 'function';\n}\nfunction add_location(element, file, line, column, char) {\n    element.__svelte_meta = {\n        loc: { file, line, column, char }\n    };\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nfunction not_equal(a, b) {\n    return a != a ? b == b : a !== b;\n}\nfunction validate_store(store, name) {\n    if (store != null && typeof store.subscribe !== 'function') {\n        throw new Error(`'${name}' is not a store with a 'subscribe' method`);\n    }\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction update_slot(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction compute_rest_props(props, keys) {\n    const rest = {};\n    keys = new Set(keys);\n    for (const k in props)\n        if (!keys.has(k) && k[0] !== '$')\n            rest[k] = props[k];\n    return rest;\n}\nfunction once(fn) {\n    let ran = false;\n    return function (...args) {\n        if (ran)\n            return;\n        ran = true;\n        fn.call(this, ...args);\n    };\n}\nfunction null_to_empty(value) {\n    return value == null ? '' : value;\n}\nfunction set_store_value(store, ret, value = ret) {\n    store.set(value);\n    return ret;\n}\nconst has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop;\n// used internally for testing\nfunction set_now(fn) {\n    now = fn;\n}\nfunction set_raf(fn) {\n    raf = fn;\n}\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * For testing purposes only!\n */\nfunction clear_loops() {\n    tasks.clear();\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction detach(node) {\n    node.parentNode.removeChild(node);\n}\nfunction destroy_each(iterations, detaching) {\n    for (let i = 0; i < iterations.length; i += 1) {\n        if (iterations[i])\n            iterations[i].d(detaching);\n    }\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction element_is(name, is) {\n    return document.createElement(name, { is });\n}\nfunction object_without_properties(obj, exclude) {\n    const target = {};\n    for (const k in obj) {\n        if (has_prop(obj, k)\n            // @ts-ignore\n            && exclude.indexOf(k) === -1) {\n            // @ts-ignore\n            target[k] = obj[k];\n        }\n    }\n    return target;\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction self(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.target === this)\n            fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value') {\n            node.value = node[key] = attributes[key];\n        }\n        else if (descriptors[key] && descriptors[key].set) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction set_svg_attributes(node, attributes) {\n    for (const key in attributes) {\n        attr(node, key, attributes[key]);\n    }\n}\nfunction set_custom_element_data(node, prop, value) {\n    if (prop in node) {\n        node[prop] = value;\n    }\n    else {\n        attr(node, prop, value);\n    }\n}\nfunction xlink_attr(node, attribute, value) {\n    node.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\nfunction get_binding_group_value(group, __value, checked) {\n    const value = new Set();\n    for (let i = 0; i < group.length; i += 1) {\n        if (group[i].checked)\n            value.add(group[i].__value);\n    }\n    if (!checked) {\n        value.delete(__value);\n    }\n    return Array.from(value);\n}\nfunction to_number(value) {\n    return value === '' ? undefined : +value;\n}\nfunction time_ranges_to_array(ranges) {\n    const array = [];\n    for (let i = 0; i < ranges.length; i += 1) {\n        array.push({ start: ranges.start(i), end: ranges.end(i) });\n    }\n    return array;\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction claim_element(nodes, name, attributes, svg) {\n    for (let i = 0; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeName === name) {\n            let j = 0;\n            const remove = [];\n            while (j < node.attributes.length) {\n                const attribute = node.attributes[j++];\n                if (!attributes[attribute.name]) {\n                    remove.push(attribute.name);\n                }\n            }\n            for (let k = 0; k < remove.length; k++) {\n                node.removeAttribute(remove[k]);\n            }\n            return nodes.splice(i, 1)[0];\n        }\n    }\n    return svg ? svg_element(name) : element(name);\n}\nfunction claim_text(nodes, data) {\n    for (let i = 0; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeType === 3) {\n            node.data = '' + data;\n            return nodes.splice(i, 1)[0];\n        }\n    }\n    return text(data);\n}\nfunction claim_space(nodes) {\n    return claim_text(nodes, ' ');\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.wholeText !== data)\n        text.data = data;\n}\nfunction set_input_value(input, value) {\n    input.value = value == null ? '' : value;\n}\nfunction set_input_type(input, type) {\n    try {\n        input.type = type;\n    }\n    catch (e) {\n        // do nothing\n    }\n}\nfunction set_style(node, key, value, important) {\n    node.style.setProperty(key, value, important ? 'important' : '');\n}\nfunction select_option(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        if (option.__value === value) {\n            option.selected = true;\n            return;\n        }\n    }\n}\nfunction select_options(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        option.selected = ~value.indexOf(option.__value);\n    }\n}\nfunction select_value(select) {\n    const selected_option = select.querySelector(':checked') || select.options[0];\n    return selected_option && selected_option.__value;\n}\nfunction select_multiple_value(select) {\n    return [].map.call(select.querySelectorAll(':checked'), option => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\nlet crossorigin;\nfunction is_crossorigin() {\n    if (crossorigin === undefined) {\n        crossorigin = false;\n        try {\n            if (typeof window !== 'undefined' && window.parent) {\n                void window.parent.document;\n            }\n        }\n        catch (error) {\n            crossorigin = true;\n        }\n    }\n    return crossorigin;\n}\nfunction add_resize_listener(node, fn) {\n    const computed_style = getComputedStyle(node);\n    const z_index = (parseInt(computed_style.zIndex) || 0) - 1;\n    if (computed_style.position === 'static') {\n        node.style.position = 'relative';\n    }\n    const iframe = element('iframe');\n    iframe.setAttribute('style', `display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ` +\n        `overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: ${z_index};`);\n    iframe.setAttribute('aria-hidden', 'true');\n    iframe.tabIndex = -1;\n    const crossorigin = is_crossorigin();\n    let unsubscribe;\n    if (crossorigin) {\n        iframe.src = `data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>`;\n        unsubscribe = listen(window, 'message', (event) => {\n            if (event.source === iframe.contentWindow)\n                fn();\n        });\n    }\n    else {\n        iframe.src = 'about:blank';\n        iframe.onload = () => {\n            unsubscribe = listen(iframe.contentWindow, 'resize', fn);\n        };\n    }\n    append(node, iframe);\n    return () => {\n        if (crossorigin) {\n            unsubscribe();\n        }\n        else if (unsubscribe && iframe.contentWindow) {\n            unsubscribe();\n        }\n        detach(iframe);\n    };\n}\nfunction toggle_class(element, name, toggle) {\n    element.classList[toggle ? 'add' : 'remove'](name);\n}\nfunction custom_event(type, detail) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, false, false, detail);\n    return e;\n}\nfunction query_selector_all(selector, parent = document.body) {\n    return Array.from(parent.querySelectorAll(selector));\n}\nclass HtmlTag {\n    constructor(anchor = null) {\n        this.a = anchor;\n        this.e = this.n = null;\n    }\n    m(html, target, anchor = null) {\n        if (!this.e) {\n            this.e = element(target.nodeName);\n            this.t = target;\n            this.h(html);\n        }\n        this.i(anchor);\n    }\n    h(html) {\n        this.e.innerHTML = html;\n        this.n = Array.from(this.e.childNodes);\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert(this.t, this.n[i], anchor);\n        }\n    }\n    p(html) {\n        this.d();\n        this.h(html);\n        this.i(this.a);\n    }\n    d() {\n        this.n.forEach(detach);\n    }\n}\n\nconst active_docs = new Set();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = node.ownerDocument;\n    active_docs.add(doc);\n    const stylesheet = doc.__svelte_stylesheet || (doc.__svelte_stylesheet = doc.head.appendChild(element('style')).sheet);\n    const current_rules = doc.__svelte_rules || (doc.__svelte_rules = {});\n    if (!current_rules[name]) {\n        current_rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ``}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        active_docs.forEach(doc => {\n            const stylesheet = doc.__svelte_stylesheet;\n            let i = stylesheet.cssRules.length;\n            while (i--)\n                stylesheet.deleteRule(i);\n            doc.__svelte_rules = {};\n        });\n        active_docs.clear();\n    });\n}\n\nfunction create_animation(node, from, fn, params) {\n    if (!from)\n        return noop;\n    const to = node.getBoundingClientRect();\n    if (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom)\n        return noop;\n    const { delay = 0, duration = 300, easing = identity, \n    // @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n    start: start_time = now() + delay, \n    // @ts-ignore todo:\n    end = start_time + duration, tick = noop, css } = fn(node, { from, to }, params);\n    let running = true;\n    let started = false;\n    let name;\n    function start() {\n        if (css) {\n            name = create_rule(node, 0, 1, duration, delay, easing, css);\n        }\n        if (!delay) {\n            started = true;\n        }\n    }\n    function stop() {\n        if (css)\n            delete_rule(node, name);\n        running = false;\n    }\n    loop(now => {\n        if (!started && now >= start_time) {\n            started = true;\n        }\n        if (started && now >= end) {\n            tick(1, 0);\n            stop();\n        }\n        if (!running) {\n            return false;\n        }\n        if (started) {\n            const p = now - start_time;\n            const t = 0 + 1 * easing(p / duration);\n            tick(t, 1 - t);\n        }\n        return true;\n    });\n    start();\n    tick(0, 1);\n    return stop;\n}\nfunction fix_position(node) {\n    const style = getComputedStyle(node);\n    if (style.position !== 'absolute' && style.position !== 'fixed') {\n        const { width, height } = style;\n        const a = node.getBoundingClientRect();\n        node.style.position = 'absolute';\n        node.style.width = width;\n        node.style.height = height;\n        add_transform(node, a);\n    }\n}\nfunction add_transform(node, a) {\n    const b = node.getBoundingClientRect();\n    if (a.left !== b.left || a.top !== b.top) {\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        node.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n    }\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error(`Function called outside component initialization`);\n    return current_component;\n}\nfunction beforeUpdate(fn) {\n    get_current_component().$$.before_update.push(fn);\n}\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail);\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n        }\n    };\n}\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n}\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        callbacks.slice().forEach(fn => fn(event));\n    }\n}\n\nconst dirty_components = [];\nconst intros = { enabled: false };\nconst binding_callbacks = [];\nconst render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction tick() {\n    schedule_update();\n    return resolved_promise;\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\nlet flushing = false;\nconst seen_callbacks = new Set();\nfunction flush() {\n    if (flushing)\n        return;\n    flushing = true;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        for (let i = 0; i < dirty_components.length; i += 1) {\n            const component = dirty_components[i];\n            set_current_component(component);\n            update(component.$$);\n        }\n        dirty_components.length = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    flushing = false;\n    seen_callbacks.clear();\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_in_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = false;\n    let animation_name;\n    let task;\n    let uid = 0;\n    function cleanup() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n        tick(0, 1);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        if (task)\n            task.abort();\n        running = true;\n        add_render_callback(() => dispatch(node, true, 'start'));\n        task = loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(1, 0);\n                    dispatch(node, true, 'end');\n                    cleanup();\n                    return running = false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(t, 1 - t);\n                }\n            }\n            return running;\n        });\n    }\n    let started = false;\n    return {\n        start() {\n            if (started)\n                return;\n            delete_rule(node);\n            if (is_function(config)) {\n                config = config();\n                wait().then(go);\n            }\n            else {\n                go();\n            }\n        },\n        invalidate() {\n            started = false;\n        },\n        end() {\n            if (running) {\n                cleanup();\n                running = false;\n            }\n        }\n    };\n}\nfunction create_out_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = true;\n    let animation_name;\n    const group = outros;\n    group.r += 1;\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        add_render_callback(() => dispatch(node, false, 'start'));\n        loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(0, 1);\n                    dispatch(node, false, 'end');\n                    if (!--group.r) {\n                        // this will result in `end()` being called,\n                        // so we don't need to clean up here\n                        run_all(group.c);\n                    }\n                    return false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(1 - t, t);\n                }\n            }\n            return running;\n        });\n    }\n    if (is_function(config)) {\n        wait().then(() => {\n            // @ts-ignore\n            config = config();\n            go();\n        });\n    }\n    else {\n        go();\n    }\n    return {\n        end(reset) {\n            if (reset && config.tick) {\n                config.tick(1, 0);\n            }\n            if (running) {\n                if (animation_name)\n                    delete_rule(node, animation_name);\n                running = false;\n            }\n        }\n    };\n}\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    let config = fn(node, params);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = program.b - t;\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro — we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro — needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config();\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nfunction handle_promise(promise, info) {\n    const token = info.token = {};\n    function update(type, index, key, value) {\n        if (info.token !== token)\n            return;\n        info.resolved = value;\n        let child_ctx = info.ctx;\n        if (key !== undefined) {\n            child_ctx = child_ctx.slice();\n            child_ctx[key] = value;\n        }\n        const block = type && (info.current = type)(child_ctx);\n        let needs_flush = false;\n        if (info.block) {\n            if (info.blocks) {\n                info.blocks.forEach((block, i) => {\n                    if (i !== index && block) {\n                        group_outros();\n                        transition_out(block, 1, 1, () => {\n                            info.blocks[i] = null;\n                        });\n                        check_outros();\n                    }\n                });\n            }\n            else {\n                info.block.d(1);\n            }\n            block.c();\n            transition_in(block, 1);\n            block.m(info.mount(), info.anchor);\n            needs_flush = true;\n        }\n        info.block = block;\n        if (info.blocks)\n            info.blocks[index] = block;\n        if (needs_flush) {\n            flush();\n        }\n    }\n    if (is_promise(promise)) {\n        const current_component = get_current_component();\n        promise.then(value => {\n            set_current_component(current_component);\n            update(info.then, 1, info.value, value);\n            set_current_component(null);\n        }, error => {\n            set_current_component(current_component);\n            update(info.catch, 2, info.error, error);\n            set_current_component(null);\n        });\n        // if we previously had a then/catch block, destroy it\n        if (info.current !== info.pending) {\n            update(info.pending, 0);\n            return true;\n        }\n    }\n    else {\n        if (info.current !== info.then) {\n            update(info.then, 1, info.value, promise);\n            return true;\n        }\n        info.resolved = promise;\n    }\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction fix_and_destroy_block(block, lookup) {\n    block.f();\n    destroy_block(block, lookup);\n}\nfunction fix_and_outro_and_destroy_block(block, lookup) {\n    block.f();\n    outro_and_destroy_block(block, lookup);\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            block.p(child_ctx, dirty);\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next);\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    return new_blocks;\n}\nfunction validate_each_keys(ctx, list, get_context, get_key) {\n    const keys = new Set();\n    for (let i = 0; i < list.length; i++) {\n        const key = get_key(get_context(ctx, list, i));\n        if (keys.has(key)) {\n            throw new Error(`Cannot have duplicate keys in a keyed each`);\n        }\n        keys.add(key);\n    }\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\n// source: https://html.spec.whatwg.org/multipage/indices.html\nconst boolean_attributes = new Set([\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'async',\n    'autofocus',\n    'autoplay',\n    'checked',\n    'controls',\n    'default',\n    'defer',\n    'disabled',\n    'formnovalidate',\n    'hidden',\n    'ismap',\n    'loop',\n    'multiple',\n    'muted',\n    'nomodule',\n    'novalidate',\n    'open',\n    'playsinline',\n    'readonly',\n    'required',\n    'reversed',\n    'selected'\n]);\n\nconst invalid_attribute_name_character = /[\\s'\">/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nfunction spread(args, classes_to_add) {\n    const attributes = Object.assign({}, ...args);\n    if (classes_to_add) {\n        if (attributes.class == null) {\n            attributes.class = classes_to_add;\n        }\n        else {\n            attributes.class += ' ' + classes_to_add;\n        }\n    }\n    let str = '';\n    Object.keys(attributes).forEach(name => {\n        if (invalid_attribute_name_character.test(name))\n            return;\n        const value = attributes[name];\n        if (value === true)\n            str += \" \" + name;\n        else if (boolean_attributes.has(name.toLowerCase())) {\n            if (value)\n                str += \" \" + name;\n        }\n        else if (value != null) {\n            str += ` ${name}=\"${String(value).replace(/\"/g, '&#34;').replace(/'/g, '&#39;')}\"`;\n        }\n    });\n    return str;\n}\nconst escaped = {\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;'\n};\nfunction escape(html) {\n    return String(html).replace(/[\"'&<>]/g, match => escaped[match]);\n}\nfunction each(items, fn) {\n    let str = '';\n    for (let i = 0; i < items.length; i += 1) {\n        str += fn(items[i], i);\n    }\n    return str;\n}\nconst missing_component = {\n    $$render: () => ''\n};\nfunction validate_component(component, name) {\n    if (!component || !component.$$render) {\n        if (name === 'svelte:component')\n            name += ' this={...}';\n        throw new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules`);\n    }\n    return component;\n}\nfunction debug(file, line, column, values) {\n    console.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`); // eslint-disable-line no-console\n    console.log(values); // eslint-disable-line no-console\n    return '';\n}\nlet on_destroy;\nfunction create_ssr_component(fn) {\n    function $$render(result, props, bindings, slots) {\n        const parent_component = current_component;\n        const $$ = {\n            on_destroy,\n            context: new Map(parent_component ? parent_component.$$.context : []),\n            // these will be immediately discarded\n            on_mount: [],\n            before_update: [],\n            after_update: [],\n            callbacks: blank_object()\n        };\n        set_current_component({ $$ });\n        const html = fn(result, props, bindings, slots);\n        set_current_component(parent_component);\n        return html;\n    }\n    return {\n        render: (props = {}, options = {}) => {\n            on_destroy = [];\n            const result = { title: '', head: '', css: new Set() };\n            const html = $$render(result, props, {}, options);\n            run_all(on_destroy);\n            return {\n                html,\n                css: {\n                    code: Array.from(result.css).map(css => css.code).join('\\n'),\n                    map: null // TODO\n                },\n                head: result.title + result.head\n            };\n        },\n        $$render\n    };\n}\nfunction add_attribute(name, value, boolean) {\n    if (value == null || (boolean && !value))\n        return '';\n    return ` ${name}${value === true ? '' : `=${typeof value === 'string' ? JSON.stringify(escape(value)) : `\"${value}\"`}`}`;\n}\nfunction add_classes(classes) {\n    return classes ? ` class=\"${classes}\"` : ``;\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction claim_component(block, parent_nodes) {\n    block && block.l(parent_nodes);\n}\nfunction mount_component(component, target, anchor) {\n    const { fragment, on_mount, on_destroy, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    // onMount happens before the initial afterUpdate\n    add_render_callback(() => {\n        const new_on_destroy = on_mount.map(run).filter(is_function);\n        if (on_destroy) {\n            on_destroy.push(...new_on_destroy);\n        }\n        else {\n            // Edge case - component was destroyed immediately,\n            // most likely as a result of a binding initialising\n            run_all(new_on_destroy);\n        }\n        component.$$.on_mount = [];\n    });\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const prop_values = options.props || {};\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: null,\n        // state\n        props,\n        update: noop,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(parent_component ? parent_component.$$.context : []),\n        // everything else\n        callbacks: blank_object(),\n        dirty\n    };\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, prop_values, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if ($$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor);\n        flush();\n    }\n    set_current_component(parent_component);\n}\nlet SvelteElement;\nif (typeof HTMLElement === 'function') {\n    SvelteElement = class extends HTMLElement {\n        constructor() {\n            super();\n            this.attachShadow({ mode: 'open' });\n        }\n        connectedCallback() {\n            // @ts-ignore todo: improve typings\n            for (const key in this.$$.slotted) {\n                // @ts-ignore todo: improve typings\n                this.appendChild(this.$$.slotted[key]);\n            }\n        }\n        attributeChangedCallback(attr, _oldValue, newValue) {\n            this[attr] = newValue;\n        }\n        $destroy() {\n            destroy_component(this, 1);\n            this.$destroy = noop;\n        }\n        $on(type, callback) {\n            // TODO should this delegate to addEventListener?\n            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n            callbacks.push(callback);\n            return () => {\n                const index = callbacks.indexOf(callback);\n                if (index !== -1)\n                    callbacks.splice(index, 1);\n            };\n        }\n        $set() {\n            // overridden by instance, if it has props\n        }\n    };\n}\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop;\n    }\n    $on(type, callback) {\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set() {\n        // overridden by instance, if it has props\n    }\n}\n\nfunction dispatch_dev(type, detail) {\n    document.dispatchEvent(custom_event(type, Object.assign({ version: '3.24.0' }, detail)));\n}\nfunction append_dev(target, node) {\n    dispatch_dev(\"SvelteDOMInsert\", { target, node });\n    append(target, node);\n}\nfunction insert_dev(target, node, anchor) {\n    dispatch_dev(\"SvelteDOMInsert\", { target, node, anchor });\n    insert(target, node, anchor);\n}\nfunction detach_dev(node) {\n    dispatch_dev(\"SvelteDOMRemove\", { node });\n    detach(node);\n}\nfunction detach_between_dev(before, after) {\n    while (before.nextSibling && before.nextSibling !== after) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction detach_before_dev(after) {\n    while (after.previousSibling) {\n        detach_dev(after.previousSibling);\n    }\n}\nfunction detach_after_dev(before) {\n    while (before.nextSibling) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction listen_dev(node, event, handler, options, has_prevent_default, has_stop_propagation) {\n    const modifiers = options === true ? [\"capture\"] : options ? Array.from(Object.keys(options)) : [];\n    if (has_prevent_default)\n        modifiers.push('preventDefault');\n    if (has_stop_propagation)\n        modifiers.push('stopPropagation');\n    dispatch_dev(\"SvelteDOMAddEventListener\", { node, event, handler, modifiers });\n    const dispose = listen(node, event, handler, options);\n    return () => {\n        dispatch_dev(\"SvelteDOMRemoveEventListener\", { node, event, handler, modifiers });\n        dispose();\n    };\n}\nfunction attr_dev(node, attribute, value) {\n    attr(node, attribute, value);\n    if (value == null)\n        dispatch_dev(\"SvelteDOMRemoveAttribute\", { node, attribute });\n    else\n        dispatch_dev(\"SvelteDOMSetAttribute\", { node, attribute, value });\n}\nfunction prop_dev(node, property, value) {\n    node[property] = value;\n    dispatch_dev(\"SvelteDOMSetProperty\", { node, property, value });\n}\nfunction dataset_dev(node, property, value) {\n    node.dataset[property] = value;\n    dispatch_dev(\"SvelteDOMSetDataset\", { node, property, value });\n}\nfunction set_data_dev(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    dispatch_dev(\"SvelteDOMSetData\", { node: text, data });\n    text.data = data;\n}\nfunction validate_each_argument(arg) {\n    if (typeof arg !== 'string' && !(arg && typeof arg === 'object' && 'length' in arg)) {\n        let msg = '{#each} only iterates over array-like objects.';\n        if (typeof Symbol === 'function' && arg && Symbol.iterator in arg) {\n            msg += ' You can use a spread to convert this iterable into an array.';\n        }\n        throw new Error(msg);\n    }\n}\nfunction validate_slots(name, slot, keys) {\n    for (const slot_key of Object.keys(slot)) {\n        if (!~keys.indexOf(slot_key)) {\n            console.warn(`<${name}> received an unexpected slot \"${slot_key}\".`);\n        }\n    }\n}\nclass SvelteComponentDev extends SvelteComponent {\n    constructor(options) {\n        if (!options || (!options.target && !options.$$inline)) {\n            throw new Error(`'target' is a required option`);\n        }\n        super();\n    }\n    $destroy() {\n        super.$destroy();\n        this.$destroy = () => {\n            console.warn(`Component was already destroyed`); // eslint-disable-line no-console\n        };\n    }\n    $capture_state() { }\n    $inject_state() { }\n}\nfunction loop_guard(timeout) {\n    const start = Date.now();\n    return () => {\n        if (Date.now() - start > timeout) {\n            throw new Error(`Infinite loop detected`);\n        }\n    };\n}\n\nexport { HtmlTag, SvelteComponent, SvelteComponentDev, SvelteElement, action_destroyer, add_attribute, add_classes, add_flush_callback, add_location, add_render_callback, add_resize_listener, add_transform, afterUpdate, append, append_dev, assign, attr, attr_dev, beforeUpdate, bind, binding_callbacks, blank_object, bubble, check_outros, children, claim_component, claim_element, claim_space, claim_text, clear_loops, component_subscribe, compute_rest_props, createEventDispatcher, create_animation, create_bidirectional_transition, create_component, create_in_transition, create_out_transition, create_slot, create_ssr_component, current_component, custom_event, dataset_dev, debug, destroy_block, destroy_component, destroy_each, detach, detach_after_dev, detach_before_dev, detach_between_dev, detach_dev, dirty_components, dispatch_dev, each, element, element_is, empty, escape, escaped, exclude_internal_props, fix_and_destroy_block, fix_and_outro_and_destroy_block, fix_position, flush, getContext, get_binding_group_value, get_current_component, get_slot_changes, get_slot_context, get_spread_object, get_spread_update, get_store_value, globals, group_outros, handle_promise, has_prop, identity, init, insert, insert_dev, intros, invalid_attribute_name_character, is_client, is_crossorigin, is_function, is_promise, listen, listen_dev, loop, loop_guard, missing_component, mount_component, noop, not_equal, now, null_to_empty, object_without_properties, onDestroy, onMount, once, outro_and_destroy_block, prevent_default, prop_dev, query_selector_all, raf, run, run_all, safe_not_equal, schedule_update, select_multiple_value, select_option, select_options, select_value, self, setContext, set_attributes, set_current_component, set_custom_element_data, set_data, set_data_dev, set_input_type, set_input_value, set_now, set_raf, set_store_value, set_style, set_svg_attributes, space, spread, stop_propagation, subscribe, svg_element, text, tick, time_ranges_to_array, to_number, toggle_class, transition_in, transition_out, update_keyed_each, update_slot, validate_component, validate_each_argument, validate_each_keys, validate_slots, validate_store, xlink_attr };\n","import { cubicInOut, linear, cubicOut } from '../easing';\nimport { is_function, assign } from '../internal';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\n\nfunction blur(node, { delay = 0, duration = 400, easing = cubicInOut, amount = 5, opacity = 0 }) {\n    const style = getComputedStyle(node);\n    const target_opacity = +style.opacity;\n    const f = style.filter === 'none' ? '' : style.filter;\n    const od = target_opacity * (1 - opacity);\n    return {\n        delay,\n        duration,\n        easing,\n        css: (_t, u) => `opacity: ${target_opacity - (od * u)}; filter: ${f} blur(${u * amount}px);`\n    };\n}\nfunction fade(node, { delay = 0, duration = 400, easing = linear }) {\n    const o = +getComputedStyle(node).opacity;\n    return {\n        delay,\n        duration,\n        easing,\n        css: t => `opacity: ${t * o}`\n    };\n}\nfunction fly(node, { delay = 0, duration = 400, easing = cubicOut, x = 0, y = 0, opacity = 0 }) {\n    const style = getComputedStyle(node);\n    const target_opacity = +style.opacity;\n    const transform = style.transform === 'none' ? '' : style.transform;\n    const od = target_opacity * (1 - opacity);\n    return {\n        delay,\n        duration,\n        easing,\n        css: (t, u) => `\n\t\t\ttransform: ${transform} translate(${(1 - t) * x}px, ${(1 - t) * y}px);\n\t\t\topacity: ${target_opacity - (od * u)}`\n    };\n}\nfunction slide(node, { delay = 0, duration = 400, easing = cubicOut }) {\n    const style = getComputedStyle(node);\n    const opacity = +style.opacity;\n    const height = parseFloat(style.height);\n    const padding_top = parseFloat(style.paddingTop);\n    const padding_bottom = parseFloat(style.paddingBottom);\n    const margin_top = parseFloat(style.marginTop);\n    const margin_bottom = parseFloat(style.marginBottom);\n    const border_top_width = parseFloat(style.borderTopWidth);\n    const border_bottom_width = parseFloat(style.borderBottomWidth);\n    return {\n        delay,\n        duration,\n        easing,\n        css: t => `overflow: hidden;` +\n            `opacity: ${Math.min(t * 20, 1) * opacity};` +\n            `height: ${t * height}px;` +\n            `padding-top: ${t * padding_top}px;` +\n            `padding-bottom: ${t * padding_bottom}px;` +\n            `margin-top: ${t * margin_top}px;` +\n            `margin-bottom: ${t * margin_bottom}px;` +\n            `border-top-width: ${t * border_top_width}px;` +\n            `border-bottom-width: ${t * border_bottom_width}px;`\n    };\n}\nfunction scale(node, { delay = 0, duration = 400, easing = cubicOut, start = 0, opacity = 0 }) {\n    const style = getComputedStyle(node);\n    const target_opacity = +style.opacity;\n    const transform = style.transform === 'none' ? '' : style.transform;\n    const sd = 1 - start;\n    const od = target_opacity * (1 - opacity);\n    return {\n        delay,\n        duration,\n        easing,\n        css: (_t, u) => `\n\t\t\ttransform: ${transform} scale(${1 - (sd * u)});\n\t\t\topacity: ${target_opacity - (od * u)}\n\t\t`\n    };\n}\nfunction draw(node, { delay = 0, speed, duration, easing = cubicInOut }) {\n    const len = node.getTotalLength();\n    if (duration === undefined) {\n        if (speed === undefined) {\n            duration = 800;\n        }\n        else {\n            duration = len / speed;\n        }\n    }\n    else if (typeof duration === 'function') {\n        duration = duration(len);\n    }\n    return {\n        delay,\n        duration,\n        easing,\n        css: (t, u) => `stroke-dasharray: ${t * len} ${u * len}`\n    };\n}\nfunction crossfade(_a) {\n    var { fallback } = _a, defaults = __rest(_a, [\"fallback\"]);\n    const to_receive = new Map();\n    const to_send = new Map();\n    function crossfade(from, node, params) {\n        const { delay = 0, duration = d => Math.sqrt(d) * 30, easing = cubicOut } = assign(assign({}, defaults), params);\n        const to = node.getBoundingClientRect();\n        const dx = from.left - to.left;\n        const dy = from.top - to.top;\n        const dw = from.width / to.width;\n        const dh = from.height / to.height;\n        const d = Math.sqrt(dx * dx + dy * dy);\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        const opacity = +style.opacity;\n        return {\n            delay,\n            duration: is_function(duration) ? duration(d) : duration,\n            easing,\n            css: (t, u) => `\n\t\t\t\topacity: ${t * opacity};\n\t\t\t\ttransform-origin: top left;\n\t\t\t\ttransform: ${transform} translate(${u * dx}px,${u * dy}px) scale(${t + (1 - t) * dw}, ${t + (1 - t) * dh});\n\t\t\t`\n        };\n    }\n    function transition(items, counterparts, intro) {\n        return (node, params) => {\n            items.set(params.key, {\n                rect: node.getBoundingClientRect()\n            });\n            return () => {\n                if (counterparts.has(params.key)) {\n                    const { rect } = counterparts.get(params.key);\n                    counterparts.delete(params.key);\n                    return crossfade(rect, node, params);\n                }\n                // if the node is disappearing altogether\n                // (i.e. wasn't claimed by the other list)\n                // then we need to supply an outro\n                items.delete(params.key);\n                return fallback && fallback(node, params, intro);\n            };\n        };\n    }\n    return [\n        transition(to_send, to_receive, false),\n        transition(to_receive, to_send, true)\n    ];\n}\n\nexport { blur, crossfade, draw, fade, fly, scale, slide };\n","export const rings = [\r\n    {\r\n        locked: false,\r\n        name: 'Prime material plane',\r\n    },\r\n    {\r\n        locked: true,\r\n        name: 'The Far Reaches',\r\n        planes: [\r\n            {\r\n                id: 1,\r\n                name: 'just a fucking spaceship',\r\n                locked: true,\r\n                description: \"it's a fucking space ship\"\r\n            },\r\n            {\r\n                id: 2,\r\n                name: 'just a fucking spaceship',\r\n                locked: true,\r\n                description: \"it's a fucking space ship\"\r\n            },\r\n            {\r\n                id: 3,\r\n                name: 'just a fucking spaceship',\r\n                locked: true,\r\n                description: \"it's a fucking space ship\"\r\n            },\r\n        ]\r\n    },\r\n    {\r\n        locked: true,\r\n        name: 'Planar boundaries',\r\n        planes: [\r\n            {\r\n                id: 4,\r\n                name: 'Elemental Plane',\r\n                locked: true,\r\n                description: \"the elemental plane\"\r\n            },\r\n            {\r\n                id: 5,\r\n                name: 'Elemental Plane',\r\n                locked: true,\r\n                description: \"the elemental plane\"\r\n            },\r\n            {\r\n                id: 6,\r\n                name: 'Elemental Plane',\r\n                locked: true,\r\n                description: \"the elemental plane\"\r\n            },\r\n        ]\r\n    },\r\n    {\r\n        locked: true,\r\n        name: 'Prime echoes',\r\n        planes: [\r\n            {\r\n                id: 7,\r\n                name: 'Feywild',\r\n                locked: false,\r\n                description: \"An echo of the Prime Material Plane, skewing toward the light. The Fey make their home here.\"\r\n            },\r\n            {\r\n                id: 8,\r\n                name: 'The Shadowfell',\r\n                locked: false,\r\n                description: \"An echo of the Prime Material Plane, skewing toward the shadow. Shadows are not inherently evil, but evil finds a home in shadow.\"\r\n            },\r\n            {\r\n                id: 9,\r\n                name: \"Louie's Domain\",\r\n                locked: false,\r\n                description: \"A domain which, curiously, contains only a single person.\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        locked: false,\r\n        name: 'Ephemeral Planes',\r\n        planes: [\r\n            {\r\n                id: 10,\r\n                name: 'Sphinxlandia',\r\n                locked: false,\r\n                description: \"A beautiful, empty sky, save for a platform with a pyramid. A lone figure sits at the entrance, too far for you to see clearly\"\r\n            },\r\n            {\r\n                id: 11,\r\n                name: 'Ethereal plane',\r\n                locked: false,\r\n                description: \"The Ethereal Plane, barely an echo of the Prime Material Plane. Mages hide here.\"\r\n            }\r\n        ]\r\n    },\r\n];\r\n","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n/** Error thrown when an HTTP request fails. */\r\nvar HttpError = /** @class */ (function (_super) {\r\n    __extends(HttpError, _super);\r\n    /** Constructs a new instance of {@link @microsoft/signalr.HttpError}.\r\n     *\r\n     * @param {string} errorMessage A descriptive error message.\r\n     * @param {number} statusCode The HTTP status code represented by this error.\r\n     */\r\n    function HttpError(errorMessage, statusCode) {\r\n        var _newTarget = this.constructor;\r\n        var _this = this;\r\n        var trueProto = _newTarget.prototype;\r\n        _this = _super.call(this, errorMessage) || this;\r\n        _this.statusCode = statusCode;\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        _this.__proto__ = trueProto;\r\n        return _this;\r\n    }\r\n    return HttpError;\r\n}(Error));\r\nexport { HttpError };\r\n/** Error thrown when a timeout elapses. */\r\nvar TimeoutError = /** @class */ (function (_super) {\r\n    __extends(TimeoutError, _super);\r\n    /** Constructs a new instance of {@link @microsoft/signalr.TimeoutError}.\r\n     *\r\n     * @param {string} errorMessage A descriptive error message.\r\n     */\r\n    function TimeoutError(errorMessage) {\r\n        var _newTarget = this.constructor;\r\n        if (errorMessage === void 0) { errorMessage = \"A timeout occurred.\"; }\r\n        var _this = this;\r\n        var trueProto = _newTarget.prototype;\r\n        _this = _super.call(this, errorMessage) || this;\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        _this.__proto__ = trueProto;\r\n        return _this;\r\n    }\r\n    return TimeoutError;\r\n}(Error));\r\nexport { TimeoutError };\r\n/** Error thrown when an action is aborted. */\r\nvar AbortError = /** @class */ (function (_super) {\r\n    __extends(AbortError, _super);\r\n    /** Constructs a new instance of {@link AbortError}.\r\n     *\r\n     * @param {string} errorMessage A descriptive error message.\r\n     */\r\n    function AbortError(errorMessage) {\r\n        var _newTarget = this.constructor;\r\n        if (errorMessage === void 0) { errorMessage = \"An abort occurred.\"; }\r\n        var _this = this;\r\n        var trueProto = _newTarget.prototype;\r\n        _this = _super.call(this, errorMessage) || this;\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        _this.__proto__ = trueProto;\r\n        return _this;\r\n    }\r\n    return AbortError;\r\n}(Error));\r\nexport { AbortError };\r\n//# sourceMappingURL=Errors.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\n// These values are designed to match the ASP.NET Log Levels since that's the pattern we're emulating here.\r\n/** Indicates the severity of a log message.\r\n *\r\n * Log Levels are ordered in increasing severity. So `Debug` is more severe than `Trace`, etc.\r\n */\r\nexport var LogLevel;\r\n(function (LogLevel) {\r\n    /** Log level for very low severity diagnostic messages. */\r\n    LogLevel[LogLevel[\"Trace\"] = 0] = \"Trace\";\r\n    /** Log level for low severity diagnostic messages. */\r\n    LogLevel[LogLevel[\"Debug\"] = 1] = \"Debug\";\r\n    /** Log level for informational diagnostic messages. */\r\n    LogLevel[LogLevel[\"Information\"] = 2] = \"Information\";\r\n    /** Log level for diagnostic messages that indicate a non-fatal problem. */\r\n    LogLevel[LogLevel[\"Warning\"] = 3] = \"Warning\";\r\n    /** Log level for diagnostic messages that indicate a failure in the current operation. */\r\n    LogLevel[LogLevel[\"Error\"] = 4] = \"Error\";\r\n    /** Log level for diagnostic messages that indicate a failure that will terminate the entire application. */\r\n    LogLevel[LogLevel[\"Critical\"] = 5] = \"Critical\";\r\n    /** The highest possible log level. Used when configuring logging to indicate that no log messages should be emitted. */\r\n    LogLevel[LogLevel[\"None\"] = 6] = \"None\";\r\n})(LogLevel || (LogLevel = {}));\r\n//# sourceMappingURL=ILogger.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n            t[p] = s[p];\r\n    }\r\n    return t;\r\n};\r\n/** Represents an HTTP response. */\r\nvar HttpResponse = /** @class */ (function () {\r\n    function HttpResponse(statusCode, statusText, content) {\r\n        this.statusCode = statusCode;\r\n        this.statusText = statusText;\r\n        this.content = content;\r\n    }\r\n    return HttpResponse;\r\n}());\r\nexport { HttpResponse };\r\n/** Abstraction over an HTTP client.\r\n *\r\n * This class provides an abstraction over an HTTP client so that a different implementation can be provided on different platforms.\r\n */\r\nvar HttpClient = /** @class */ (function () {\r\n    function HttpClient() {\r\n    }\r\n    HttpClient.prototype.get = function (url, options) {\r\n        return this.send(__assign({}, options, { method: \"GET\", url: url }));\r\n    };\r\n    HttpClient.prototype.post = function (url, options) {\r\n        return this.send(__assign({}, options, { method: \"POST\", url: url }));\r\n    };\r\n    HttpClient.prototype.delete = function (url, options) {\r\n        return this.send(__assign({}, options, { method: \"DELETE\", url: url }));\r\n    };\r\n    /** Gets all cookies that apply to the specified URL.\r\n     *\r\n     * @param url The URL that the cookies are valid for.\r\n     * @returns {string} A string containing all the key-value cookie pairs for the specified URL.\r\n     */\r\n    // @ts-ignore\r\n    HttpClient.prototype.getCookieString = function (url) {\r\n        return \"\";\r\n    };\r\n    return HttpClient;\r\n}());\r\nexport { HttpClient };\r\n//# sourceMappingURL=HttpClient.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\n/** A logger that does nothing when log messages are sent to it. */\r\nvar NullLogger = /** @class */ (function () {\r\n    function NullLogger() {\r\n    }\r\n    /** @inheritDoc */\r\n    // tslint:disable-next-line\r\n    NullLogger.prototype.log = function (_logLevel, _message) {\r\n    };\r\n    /** The singleton instance of the {@link @microsoft/signalr.NullLogger}. */\r\n    NullLogger.instance = new NullLogger();\r\n    return NullLogger;\r\n}());\r\nexport { NullLogger };\r\n//# sourceMappingURL=Loggers.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { NullLogger } from \"./Loggers\";\r\n/** @private */\r\nvar Arg = /** @class */ (function () {\r\n    function Arg() {\r\n    }\r\n    Arg.isRequired = function (val, name) {\r\n        if (val === null || val === undefined) {\r\n            throw new Error(\"The '\" + name + \"' argument is required.\");\r\n        }\r\n    };\r\n    Arg.isIn = function (val, values, name) {\r\n        // TypeScript enums have keys for **both** the name and the value of each enum member on the type itself.\r\n        if (!(val in values)) {\r\n            throw new Error(\"Unknown \" + name + \" value: \" + val + \".\");\r\n        }\r\n    };\r\n    return Arg;\r\n}());\r\nexport { Arg };\r\n/** @private */\r\nvar Platform = /** @class */ (function () {\r\n    function Platform() {\r\n    }\r\n    Object.defineProperty(Platform, \"isBrowser\", {\r\n        get: function () {\r\n            return typeof window === \"object\";\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Platform, \"isWebWorker\", {\r\n        get: function () {\r\n            return typeof self === \"object\" && \"importScripts\" in self;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Platform, \"isNode\", {\r\n        get: function () {\r\n            return !this.isBrowser && !this.isWebWorker;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Platform;\r\n}());\r\nexport { Platform };\r\n/** @private */\r\nexport function getDataDetail(data, includeContent) {\r\n    var detail = \"\";\r\n    if (isArrayBuffer(data)) {\r\n        detail = \"Binary data of length \" + data.byteLength;\r\n        if (includeContent) {\r\n            detail += \". Content: '\" + formatArrayBuffer(data) + \"'\";\r\n        }\r\n    }\r\n    else if (typeof data === \"string\") {\r\n        detail = \"String data of length \" + data.length;\r\n        if (includeContent) {\r\n            detail += \". Content: '\" + data + \"'\";\r\n        }\r\n    }\r\n    return detail;\r\n}\r\n/** @private */\r\nexport function formatArrayBuffer(data) {\r\n    var view = new Uint8Array(data);\r\n    // Uint8Array.map only supports returning another Uint8Array?\r\n    var str = \"\";\r\n    view.forEach(function (num) {\r\n        var pad = num < 16 ? \"0\" : \"\";\r\n        str += \"0x\" + pad + num.toString(16) + \" \";\r\n    });\r\n    // Trim of trailing space.\r\n    return str.substr(0, str.length - 1);\r\n}\r\n// Also in signalr-protocol-msgpack/Utils.ts\r\n/** @private */\r\nexport function isArrayBuffer(val) {\r\n    return val && typeof ArrayBuffer !== \"undefined\" &&\r\n        (val instanceof ArrayBuffer ||\r\n            // Sometimes we get an ArrayBuffer that doesn't satisfy instanceof\r\n            (val.constructor && val.constructor.name === \"ArrayBuffer\"));\r\n}\r\n/** @private */\r\nexport function sendMessage(logger, transportName, httpClient, url, accessTokenFactory, content, logMessageContent) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var _a, headers, token, responseType, response;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0:\r\n                    if (!accessTokenFactory) return [3 /*break*/, 2];\r\n                    return [4 /*yield*/, accessTokenFactory()];\r\n                case 1:\r\n                    token = _b.sent();\r\n                    if (token) {\r\n                        headers = (_a = {},\r\n                            _a[\"Authorization\"] = \"Bearer \" + token,\r\n                            _a);\r\n                    }\r\n                    _b.label = 2;\r\n                case 2:\r\n                    logger.log(LogLevel.Trace, \"(\" + transportName + \" transport) sending data. \" + getDataDetail(content, logMessageContent) + \".\");\r\n                    responseType = isArrayBuffer(content) ? \"arraybuffer\" : \"text\";\r\n                    return [4 /*yield*/, httpClient.post(url, {\r\n                            content: content,\r\n                            headers: headers,\r\n                            responseType: responseType,\r\n                        })];\r\n                case 3:\r\n                    response = _b.sent();\r\n                    logger.log(LogLevel.Trace, \"(\" + transportName + \" transport) request complete. Response status: \" + response.statusCode + \".\");\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\n/** @private */\r\nexport function createLogger(logger) {\r\n    if (logger === undefined) {\r\n        return new ConsoleLogger(LogLevel.Information);\r\n    }\r\n    if (logger === null) {\r\n        return NullLogger.instance;\r\n    }\r\n    if (logger.log) {\r\n        return logger;\r\n    }\r\n    return new ConsoleLogger(logger);\r\n}\r\n/** @private */\r\nvar SubjectSubscription = /** @class */ (function () {\r\n    function SubjectSubscription(subject, observer) {\r\n        this.subject = subject;\r\n        this.observer = observer;\r\n    }\r\n    SubjectSubscription.prototype.dispose = function () {\r\n        var index = this.subject.observers.indexOf(this.observer);\r\n        if (index > -1) {\r\n            this.subject.observers.splice(index, 1);\r\n        }\r\n        if (this.subject.observers.length === 0 && this.subject.cancelCallback) {\r\n            this.subject.cancelCallback().catch(function (_) { });\r\n        }\r\n    };\r\n    return SubjectSubscription;\r\n}());\r\nexport { SubjectSubscription };\r\n/** @private */\r\nvar ConsoleLogger = /** @class */ (function () {\r\n    function ConsoleLogger(minimumLogLevel) {\r\n        this.minimumLogLevel = minimumLogLevel;\r\n        this.outputConsole = console;\r\n    }\r\n    ConsoleLogger.prototype.log = function (logLevel, message) {\r\n        if (logLevel >= this.minimumLogLevel) {\r\n            switch (logLevel) {\r\n                case LogLevel.Critical:\r\n                case LogLevel.Error:\r\n                    this.outputConsole.error(\"[\" + new Date().toISOString() + \"] \" + LogLevel[logLevel] + \": \" + message);\r\n                    break;\r\n                case LogLevel.Warning:\r\n                    this.outputConsole.warn(\"[\" + new Date().toISOString() + \"] \" + LogLevel[logLevel] + \": \" + message);\r\n                    break;\r\n                case LogLevel.Information:\r\n                    this.outputConsole.info(\"[\" + new Date().toISOString() + \"] \" + LogLevel[logLevel] + \": \" + message);\r\n                    break;\r\n                default:\r\n                    // console.debug only goes to attached debuggers in Node, so we use console.log for Trace and Debug\r\n                    this.outputConsole.log(\"[\" + new Date().toISOString() + \"] \" + LogLevel[logLevel] + \": \" + message);\r\n                    break;\r\n            }\r\n        }\r\n    };\r\n    return ConsoleLogger;\r\n}());\r\nexport { ConsoleLogger };\r\n//# sourceMappingURL=Utils.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n            t[p] = s[p];\r\n    }\r\n    return t;\r\n};\r\nimport { AbortError, HttpError, TimeoutError } from \"./Errors\";\r\nimport { HttpClient, HttpResponse } from \"./HttpClient\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { isArrayBuffer } from \"./Utils\";\r\nvar requestModule;\r\nif (typeof XMLHttpRequest === \"undefined\") {\r\n    // In order to ignore the dynamic require in webpack builds we need to do this magic\r\n    // @ts-ignore: TS doesn't know about these names\r\n    var requireFunc = typeof __webpack_require__ === \"function\" ? __non_webpack_require__ : require;\r\n    requestModule = requireFunc(\"request\");\r\n}\r\n/** @private */\r\nvar NodeHttpClient = /** @class */ (function (_super) {\r\n    __extends(NodeHttpClient, _super);\r\n    function NodeHttpClient(logger) {\r\n        var _this = _super.call(this) || this;\r\n        if (typeof requestModule === \"undefined\") {\r\n            throw new Error(\"The 'request' module could not be loaded.\");\r\n        }\r\n        _this.logger = logger;\r\n        _this.cookieJar = requestModule.jar();\r\n        _this.request = requestModule.defaults({ jar: _this.cookieJar });\r\n        return _this;\r\n    }\r\n    NodeHttpClient.prototype.send = function (httpRequest) {\r\n        var _this = this;\r\n        // Check that abort was not signaled before calling send\r\n        if (httpRequest.abortSignal) {\r\n            if (httpRequest.abortSignal.aborted) {\r\n                return Promise.reject(new AbortError());\r\n            }\r\n        }\r\n        return new Promise(function (resolve, reject) {\r\n            var requestBody;\r\n            if (isArrayBuffer(httpRequest.content)) {\r\n                requestBody = Buffer.from(httpRequest.content);\r\n            }\r\n            else {\r\n                requestBody = httpRequest.content || \"\";\r\n            }\r\n            var currentRequest = _this.request(httpRequest.url, {\r\n                body: requestBody,\r\n                // If binary is expected 'null' should be used, otherwise for text 'utf8'\r\n                encoding: httpRequest.responseType === \"arraybuffer\" ? null : \"utf8\",\r\n                headers: __assign({ \r\n                    // Tell auth middleware to 401 instead of redirecting\r\n                    \"X-Requested-With\": \"XMLHttpRequest\" }, httpRequest.headers),\r\n                method: httpRequest.method,\r\n                timeout: httpRequest.timeout,\r\n            }, function (error, response, body) {\r\n                if (httpRequest.abortSignal) {\r\n                    httpRequest.abortSignal.onabort = null;\r\n                }\r\n                if (error) {\r\n                    if (error.code === \"ETIMEDOUT\") {\r\n                        _this.logger.log(LogLevel.Warning, \"Timeout from HTTP request.\");\r\n                        reject(new TimeoutError());\r\n                    }\r\n                    _this.logger.log(LogLevel.Warning, \"Error from HTTP request. \" + error);\r\n                    reject(error);\r\n                    return;\r\n                }\r\n                if (response.statusCode >= 200 && response.statusCode < 300) {\r\n                    resolve(new HttpResponse(response.statusCode, response.statusMessage || \"\", body));\r\n                }\r\n                else {\r\n                    reject(new HttpError(response.statusMessage || \"\", response.statusCode || 0));\r\n                }\r\n            });\r\n            if (httpRequest.abortSignal) {\r\n                httpRequest.abortSignal.onabort = function () {\r\n                    currentRequest.abort();\r\n                    reject(new AbortError());\r\n                };\r\n            }\r\n        });\r\n    };\r\n    NodeHttpClient.prototype.getCookieString = function (url) {\r\n        return this.cookieJar.getCookieString(url);\r\n    };\r\n    return NodeHttpClient;\r\n}(HttpClient));\r\nexport { NodeHttpClient };\r\n//# sourceMappingURL=NodeHttpClient.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\n/** Defines the type of a Hub Message. */\r\nexport var MessageType;\r\n(function (MessageType) {\r\n    /** Indicates the message is an Invocation message and implements the {@link @microsoft/signalr.InvocationMessage} interface. */\r\n    MessageType[MessageType[\"Invocation\"] = 1] = \"Invocation\";\r\n    /** Indicates the message is a StreamItem message and implements the {@link @microsoft/signalr.StreamItemMessage} interface. */\r\n    MessageType[MessageType[\"StreamItem\"] = 2] = \"StreamItem\";\r\n    /** Indicates the message is a Completion message and implements the {@link @microsoft/signalr.CompletionMessage} interface. */\r\n    MessageType[MessageType[\"Completion\"] = 3] = \"Completion\";\r\n    /** Indicates the message is a Stream Invocation message and implements the {@link @microsoft/signalr.StreamInvocationMessage} interface. */\r\n    MessageType[MessageType[\"StreamInvocation\"] = 4] = \"StreamInvocation\";\r\n    /** Indicates the message is a Cancel Invocation message and implements the {@link @microsoft/signalr.CancelInvocationMessage} interface. */\r\n    MessageType[MessageType[\"CancelInvocation\"] = 5] = \"CancelInvocation\";\r\n    /** Indicates the message is a Ping message and implements the {@link @microsoft/signalr.PingMessage} interface. */\r\n    MessageType[MessageType[\"Ping\"] = 6] = \"Ping\";\r\n    /** Indicates the message is a Close message and implements the {@link @microsoft/signalr.CloseMessage} interface. */\r\n    MessageType[MessageType[\"Close\"] = 7] = \"Close\";\r\n})(MessageType || (MessageType = {}));\r\n//# sourceMappingURL=IHubProtocol.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { AbortError, HttpError, TimeoutError } from \"./Errors\";\r\nimport { HttpClient, HttpResponse } from \"./HttpClient\";\r\nimport { LogLevel } from \"./ILogger\";\r\nvar XhrHttpClient = /** @class */ (function (_super) {\r\n    __extends(XhrHttpClient, _super);\r\n    function XhrHttpClient(logger) {\r\n        var _this = _super.call(this) || this;\r\n        _this.logger = logger;\r\n        return _this;\r\n    }\r\n    /** @inheritDoc */\r\n    XhrHttpClient.prototype.send = function (request) {\r\n        var _this = this;\r\n        // Check that abort was not signaled before calling send\r\n        if (request.abortSignal && request.abortSignal.aborted) {\r\n            return Promise.reject(new AbortError());\r\n        }\r\n        if (!request.method) {\r\n            return Promise.reject(new Error(\"No method defined.\"));\r\n        }\r\n        if (!request.url) {\r\n            return Promise.reject(new Error(\"No url defined.\"));\r\n        }\r\n        return new Promise(function (resolve, reject) {\r\n            var xhr = new XMLHttpRequest();\r\n            xhr.open(request.method, request.url, true);\r\n            xhr.withCredentials = true;\r\n            xhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\r\n            // Explicitly setting the Content-Type header for React Native on Android platform.\r\n            xhr.setRequestHeader(\"Content-Type\", \"text/plain;charset=UTF-8\");\r\n            var headers = request.headers;\r\n            if (headers) {\r\n                Object.keys(headers)\r\n                    .forEach(function (header) {\r\n                    xhr.setRequestHeader(header, headers[header]);\r\n                });\r\n            }\r\n            if (request.responseType) {\r\n                xhr.responseType = request.responseType;\r\n            }\r\n            if (request.abortSignal) {\r\n                request.abortSignal.onabort = function () {\r\n                    xhr.abort();\r\n                    reject(new AbortError());\r\n                };\r\n            }\r\n            if (request.timeout) {\r\n                xhr.timeout = request.timeout;\r\n            }\r\n            xhr.onload = function () {\r\n                if (request.abortSignal) {\r\n                    request.abortSignal.onabort = null;\r\n                }\r\n                if (xhr.status >= 200 && xhr.status < 300) {\r\n                    resolve(new HttpResponse(xhr.status, xhr.statusText, xhr.response || xhr.responseText));\r\n                }\r\n                else {\r\n                    reject(new HttpError(xhr.statusText, xhr.status));\r\n                }\r\n            };\r\n            xhr.onerror = function () {\r\n                _this.logger.log(LogLevel.Warning, \"Error from HTTP request. \" + xhr.status + \": \" + xhr.statusText + \".\");\r\n                reject(new HttpError(xhr.statusText, xhr.status));\r\n            };\r\n            xhr.ontimeout = function () {\r\n                _this.logger.log(LogLevel.Warning, \"Timeout from HTTP request.\");\r\n                reject(new TimeoutError());\r\n            };\r\n            xhr.send(request.content || \"\");\r\n        });\r\n    };\r\n    return XhrHttpClient;\r\n}(HttpClient));\r\nexport { XhrHttpClient };\r\n//# sourceMappingURL=XhrHttpClient.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { AbortError } from \"./Errors\";\r\nimport { HttpClient } from \"./HttpClient\";\r\nimport { NodeHttpClient } from \"./NodeHttpClient\";\r\nimport { XhrHttpClient } from \"./XhrHttpClient\";\r\n/** Default implementation of {@link @microsoft/signalr.HttpClient}. */\r\nvar DefaultHttpClient = /** @class */ (function (_super) {\r\n    __extends(DefaultHttpClient, _super);\r\n    /** Creates a new instance of the {@link @microsoft/signalr.DefaultHttpClient}, using the provided {@link @microsoft/signalr.ILogger} to log messages. */\r\n    function DefaultHttpClient(logger) {\r\n        var _this = _super.call(this) || this;\r\n        if (typeof XMLHttpRequest !== \"undefined\") {\r\n            _this.httpClient = new XhrHttpClient(logger);\r\n        }\r\n        else {\r\n            _this.httpClient = new NodeHttpClient(logger);\r\n        }\r\n        return _this;\r\n    }\r\n    /** @inheritDoc */\r\n    DefaultHttpClient.prototype.send = function (request) {\r\n        // Check that abort was not signaled before calling send\r\n        if (request.abortSignal && request.abortSignal.aborted) {\r\n            return Promise.reject(new AbortError());\r\n        }\r\n        if (!request.method) {\r\n            return Promise.reject(new Error(\"No method defined.\"));\r\n        }\r\n        if (!request.url) {\r\n            return Promise.reject(new Error(\"No url defined.\"));\r\n        }\r\n        return this.httpClient.send(request);\r\n    };\r\n    DefaultHttpClient.prototype.getCookieString = function (url) {\r\n        return this.httpClient.getCookieString(url);\r\n    };\r\n    return DefaultHttpClient;\r\n}(HttpClient));\r\nexport { DefaultHttpClient };\r\n//# sourceMappingURL=DefaultHttpClient.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\n// Not exported from index\r\n/** @private */\r\nvar TextMessageFormat = /** @class */ (function () {\r\n    function TextMessageFormat() {\r\n    }\r\n    TextMessageFormat.write = function (output) {\r\n        return \"\" + output + TextMessageFormat.RecordSeparator;\r\n    };\r\n    TextMessageFormat.parse = function (input) {\r\n        if (input[input.length - 1] !== TextMessageFormat.RecordSeparator) {\r\n            throw new Error(\"Message is incomplete.\");\r\n        }\r\n        var messages = input.split(TextMessageFormat.RecordSeparator);\r\n        messages.pop();\r\n        return messages;\r\n    };\r\n    TextMessageFormat.RecordSeparatorCode = 0x1e;\r\n    TextMessageFormat.RecordSeparator = String.fromCharCode(TextMessageFormat.RecordSeparatorCode);\r\n    return TextMessageFormat;\r\n}());\r\nexport { TextMessageFormat };\r\n//# sourceMappingURL=TextMessageFormat.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\nimport { TextMessageFormat } from \"./TextMessageFormat\";\r\nimport { isArrayBuffer } from \"./Utils\";\r\n/** @private */\r\nvar HandshakeProtocol = /** @class */ (function () {\r\n    function HandshakeProtocol() {\r\n    }\r\n    // Handshake request is always JSON\r\n    HandshakeProtocol.prototype.writeHandshakeRequest = function (handshakeRequest) {\r\n        return TextMessageFormat.write(JSON.stringify(handshakeRequest));\r\n    };\r\n    HandshakeProtocol.prototype.parseHandshakeResponse = function (data) {\r\n        var responseMessage;\r\n        var messageData;\r\n        var remainingData;\r\n        if (isArrayBuffer(data) || (typeof Buffer !== \"undefined\" && data instanceof Buffer)) {\r\n            // Format is binary but still need to read JSON text from handshake response\r\n            var binaryData = new Uint8Array(data);\r\n            var separatorIndex = binaryData.indexOf(TextMessageFormat.RecordSeparatorCode);\r\n            if (separatorIndex === -1) {\r\n                throw new Error(\"Message is incomplete.\");\r\n            }\r\n            // content before separator is handshake response\r\n            // optional content after is additional messages\r\n            var responseLength = separatorIndex + 1;\r\n            messageData = String.fromCharCode.apply(null, binaryData.slice(0, responseLength));\r\n            remainingData = (binaryData.byteLength > responseLength) ? binaryData.slice(responseLength).buffer : null;\r\n        }\r\n        else {\r\n            var textData = data;\r\n            var separatorIndex = textData.indexOf(TextMessageFormat.RecordSeparator);\r\n            if (separatorIndex === -1) {\r\n                throw new Error(\"Message is incomplete.\");\r\n            }\r\n            // content before separator is handshake response\r\n            // optional content after is additional messages\r\n            var responseLength = separatorIndex + 1;\r\n            messageData = textData.substring(0, responseLength);\r\n            remainingData = (textData.length > responseLength) ? textData.substring(responseLength) : null;\r\n        }\r\n        // At this point we should have just the single handshake message\r\n        var messages = TextMessageFormat.parse(messageData);\r\n        var response = JSON.parse(messages[0]);\r\n        if (response.type) {\r\n            throw new Error(\"Expected a handshake response from the server.\");\r\n        }\r\n        responseMessage = response;\r\n        // multiple messages could have arrived with handshake\r\n        // return additional data to be parsed as usual, or null if all parsed\r\n        return [remainingData, responseMessage];\r\n    };\r\n    return HandshakeProtocol;\r\n}());\r\nexport { HandshakeProtocol };\r\n//# sourceMappingURL=HandshakeProtocol.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\nimport { SubjectSubscription } from \"./Utils\";\r\n/** Stream implementation to stream items to the server. */\r\nvar Subject = /** @class */ (function () {\r\n    function Subject() {\r\n        this.observers = [];\r\n    }\r\n    Subject.prototype.next = function (item) {\r\n        for (var _i = 0, _a = this.observers; _i < _a.length; _i++) {\r\n            var observer = _a[_i];\r\n            observer.next(item);\r\n        }\r\n    };\r\n    Subject.prototype.error = function (err) {\r\n        for (var _i = 0, _a = this.observers; _i < _a.length; _i++) {\r\n            var observer = _a[_i];\r\n            if (observer.error) {\r\n                observer.error(err);\r\n            }\r\n        }\r\n    };\r\n    Subject.prototype.complete = function () {\r\n        for (var _i = 0, _a = this.observers; _i < _a.length; _i++) {\r\n            var observer = _a[_i];\r\n            if (observer.complete) {\r\n                observer.complete();\r\n            }\r\n        }\r\n    };\r\n    Subject.prototype.subscribe = function (observer) {\r\n        this.observers.push(observer);\r\n        return new SubjectSubscription(this, observer);\r\n    };\r\n    return Subject;\r\n}());\r\nexport { Subject };\r\n//# sourceMappingURL=Subject.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { HandshakeProtocol } from \"./HandshakeProtocol\";\r\nimport { MessageType } from \"./IHubProtocol\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { Subject } from \"./Subject\";\r\nimport { Arg } from \"./Utils\";\r\nvar DEFAULT_TIMEOUT_IN_MS = 30 * 1000;\r\nvar DEFAULT_PING_INTERVAL_IN_MS = 15 * 1000;\r\n/** Describes the current state of the {@link HubConnection} to the server. */\r\nexport var HubConnectionState;\r\n(function (HubConnectionState) {\r\n    /** The hub connection is disconnected. */\r\n    HubConnectionState[\"Disconnected\"] = \"Disconnected\";\r\n    /** The hub connection is connecting. */\r\n    HubConnectionState[\"Connecting\"] = \"Connecting\";\r\n    /** The hub connection is connected. */\r\n    HubConnectionState[\"Connected\"] = \"Connected\";\r\n    /** The hub connection is disconnecting. */\r\n    HubConnectionState[\"Disconnecting\"] = \"Disconnecting\";\r\n    /** The hub connection is reconnecting. */\r\n    HubConnectionState[\"Reconnecting\"] = \"Reconnecting\";\r\n})(HubConnectionState || (HubConnectionState = {}));\r\n/** Represents a connection to a SignalR Hub. */\r\nvar HubConnection = /** @class */ (function () {\r\n    function HubConnection(connection, logger, protocol, reconnectPolicy) {\r\n        var _this = this;\r\n        Arg.isRequired(connection, \"connection\");\r\n        Arg.isRequired(logger, \"logger\");\r\n        Arg.isRequired(protocol, \"protocol\");\r\n        this.serverTimeoutInMilliseconds = DEFAULT_TIMEOUT_IN_MS;\r\n        this.keepAliveIntervalInMilliseconds = DEFAULT_PING_INTERVAL_IN_MS;\r\n        this.logger = logger;\r\n        this.protocol = protocol;\r\n        this.connection = connection;\r\n        this.reconnectPolicy = reconnectPolicy;\r\n        this.handshakeProtocol = new HandshakeProtocol();\r\n        this.connection.onreceive = function (data) { return _this.processIncomingData(data); };\r\n        this.connection.onclose = function (error) { return _this.connectionClosed(error); };\r\n        this.callbacks = {};\r\n        this.methods = {};\r\n        this.closedCallbacks = [];\r\n        this.reconnectingCallbacks = [];\r\n        this.reconnectedCallbacks = [];\r\n        this.invocationId = 0;\r\n        this.receivedHandshakeResponse = false;\r\n        this.connectionState = HubConnectionState.Disconnected;\r\n        this.connectionStarted = false;\r\n        this.cachedPingMessage = this.protocol.writeMessage({ type: MessageType.Ping });\r\n    }\r\n    /** @internal */\r\n    // Using a public static factory method means we can have a private constructor and an _internal_\r\n    // create method that can be used by HubConnectionBuilder. An \"internal\" constructor would just\r\n    // be stripped away and the '.d.ts' file would have no constructor, which is interpreted as a\r\n    // public parameter-less constructor.\r\n    HubConnection.create = function (connection, logger, protocol, reconnectPolicy) {\r\n        return new HubConnection(connection, logger, protocol, reconnectPolicy);\r\n    };\r\n    Object.defineProperty(HubConnection.prototype, \"state\", {\r\n        /** Indicates the state of the {@link HubConnection} to the server. */\r\n        get: function () {\r\n            return this.connectionState;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(HubConnection.prototype, \"connectionId\", {\r\n        /** Represents the connection id of the {@link HubConnection} on the server. The connection id will be null when the connection is either\r\n         *  in the disconnected state or if the negotiation step was skipped.\r\n         */\r\n        get: function () {\r\n            return this.connection ? (this.connection.connectionId || null) : null;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(HubConnection.prototype, \"baseUrl\", {\r\n        /** Indicates the url of the {@link HubConnection} to the server. */\r\n        get: function () {\r\n            return this.connection.baseUrl || \"\";\r\n        },\r\n        /**\r\n         * Sets a new url for the HubConnection. Note that the url can only be changed when the connection is in either the Disconnected or\r\n         * Reconnecting states.\r\n         * @param {string} url The url to connect to.\r\n         */\r\n        set: function (url) {\r\n            if (this.connectionState !== HubConnectionState.Disconnected && this.connectionState !== HubConnectionState.Reconnecting) {\r\n                throw new Error(\"The HubConnection must be in the Disconnected or Reconnecting state to change the url.\");\r\n            }\r\n            if (!url) {\r\n                throw new Error(\"The HubConnection url must be a valid url.\");\r\n            }\r\n            this.connection.baseUrl = url;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /** Starts the connection.\r\n     *\r\n     * @returns {Promise<void>} A Promise that resolves when the connection has been successfully established, or rejects with an error.\r\n     */\r\n    HubConnection.prototype.start = function () {\r\n        this.startPromise = this.startWithStateTransitions();\r\n        return this.startPromise;\r\n    };\r\n    HubConnection.prototype.startWithStateTransitions = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var e_1;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (this.connectionState !== HubConnectionState.Disconnected) {\r\n                            return [2 /*return*/, Promise.reject(new Error(\"Cannot start a HubConnection that is not in the 'Disconnected' state.\"))];\r\n                        }\r\n                        this.connectionState = HubConnectionState.Connecting;\r\n                        this.logger.log(LogLevel.Debug, \"Starting HubConnection.\");\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        _a.trys.push([1, 3, , 4]);\r\n                        return [4 /*yield*/, this.startInternal()];\r\n                    case 2:\r\n                        _a.sent();\r\n                        this.connectionState = HubConnectionState.Connected;\r\n                        this.connectionStarted = true;\r\n                        this.logger.log(LogLevel.Debug, \"HubConnection connected successfully.\");\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        e_1 = _a.sent();\r\n                        this.connectionState = HubConnectionState.Disconnected;\r\n                        this.logger.log(LogLevel.Debug, \"HubConnection failed to start successfully because of error '\" + e_1 + \"'.\");\r\n                        return [2 /*return*/, Promise.reject(e_1)];\r\n                    case 4: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    HubConnection.prototype.startInternal = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var handshakePromise, handshakeRequest, e_2;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this.stopDuringStartError = undefined;\r\n                        this.receivedHandshakeResponse = false;\r\n                        handshakePromise = new Promise(function (resolve, reject) {\r\n                            _this.handshakeResolver = resolve;\r\n                            _this.handshakeRejecter = reject;\r\n                        });\r\n                        return [4 /*yield*/, this.connection.start(this.protocol.transferFormat)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        _a.label = 2;\r\n                    case 2:\r\n                        _a.trys.push([2, 5, , 7]);\r\n                        handshakeRequest = {\r\n                            protocol: this.protocol.name,\r\n                            version: this.protocol.version,\r\n                        };\r\n                        this.logger.log(LogLevel.Debug, \"Sending handshake request.\");\r\n                        return [4 /*yield*/, this.sendMessage(this.handshakeProtocol.writeHandshakeRequest(handshakeRequest))];\r\n                    case 3:\r\n                        _a.sent();\r\n                        this.logger.log(LogLevel.Information, \"Using HubProtocol '\" + this.protocol.name + \"'.\");\r\n                        // defensively cleanup timeout in case we receive a message from the server before we finish start\r\n                        this.cleanupTimeout();\r\n                        this.resetTimeoutPeriod();\r\n                        this.resetKeepAliveInterval();\r\n                        return [4 /*yield*/, handshakePromise];\r\n                    case 4:\r\n                        _a.sent();\r\n                        // It's important to check the stopDuringStartError instead of just relying on the handshakePromise\r\n                        // being rejected on close, because this continuation can run after both the handshake completed successfully\r\n                        // and the connection was closed.\r\n                        if (this.stopDuringStartError) {\r\n                            // It's important to throw instead of returning a rejected promise, because we don't want to allow any state\r\n                            // transitions to occur between now and the calling code observing the exceptions. Returning a rejected promise\r\n                            // will cause the calling continuation to get scheduled to run later.\r\n                            throw this.stopDuringStartError;\r\n                        }\r\n                        return [3 /*break*/, 7];\r\n                    case 5:\r\n                        e_2 = _a.sent();\r\n                        this.logger.log(LogLevel.Debug, \"Hub handshake failed with error '\" + e_2 + \"' during start(). Stopping HubConnection.\");\r\n                        this.cleanupTimeout();\r\n                        this.cleanupPingTimer();\r\n                        // HttpConnection.stop() should not complete until after the onclose callback is invoked.\r\n                        // This will transition the HubConnection to the disconnected state before HttpConnection.stop() completes.\r\n                        return [4 /*yield*/, this.connection.stop(e_2)];\r\n                    case 6:\r\n                        // HttpConnection.stop() should not complete until after the onclose callback is invoked.\r\n                        // This will transition the HubConnection to the disconnected state before HttpConnection.stop() completes.\r\n                        _a.sent();\r\n                        throw e_2;\r\n                    case 7: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /** Stops the connection.\r\n     *\r\n     * @returns {Promise<void>} A Promise that resolves when the connection has been successfully terminated, or rejects with an error.\r\n     */\r\n    HubConnection.prototype.stop = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var startPromise, e_3;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        startPromise = this.startPromise;\r\n                        this.stopPromise = this.stopInternal();\r\n                        return [4 /*yield*/, this.stopPromise];\r\n                    case 1:\r\n                        _a.sent();\r\n                        _a.label = 2;\r\n                    case 2:\r\n                        _a.trys.push([2, 4, , 5]);\r\n                        // Awaiting undefined continues immediately\r\n                        return [4 /*yield*/, startPromise];\r\n                    case 3:\r\n                        // Awaiting undefined continues immediately\r\n                        _a.sent();\r\n                        return [3 /*break*/, 5];\r\n                    case 4:\r\n                        e_3 = _a.sent();\r\n                        return [3 /*break*/, 5];\r\n                    case 5: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    HubConnection.prototype.stopInternal = function (error) {\r\n        if (this.connectionState === HubConnectionState.Disconnected) {\r\n            this.logger.log(LogLevel.Debug, \"Call to HubConnection.stop(\" + error + \") ignored because it is already in the disconnected state.\");\r\n            return Promise.resolve();\r\n        }\r\n        if (this.connectionState === HubConnectionState.Disconnecting) {\r\n            this.logger.log(LogLevel.Debug, \"Call to HttpConnection.stop(\" + error + \") ignored because the connection is already in the disconnecting state.\");\r\n            return this.stopPromise;\r\n        }\r\n        this.connectionState = HubConnectionState.Disconnecting;\r\n        this.logger.log(LogLevel.Debug, \"Stopping HubConnection.\");\r\n        if (this.reconnectDelayHandle) {\r\n            // We're in a reconnect delay which means the underlying connection is currently already stopped.\r\n            // Just clear the handle to stop the reconnect loop (which no one is waiting on thankfully) and\r\n            // fire the onclose callbacks.\r\n            this.logger.log(LogLevel.Debug, \"Connection stopped during reconnect delay. Done reconnecting.\");\r\n            clearTimeout(this.reconnectDelayHandle);\r\n            this.reconnectDelayHandle = undefined;\r\n            this.completeClose();\r\n            return Promise.resolve();\r\n        }\r\n        this.cleanupTimeout();\r\n        this.cleanupPingTimer();\r\n        this.stopDuringStartError = error || new Error(\"The connection was stopped before the hub handshake could complete.\");\r\n        // HttpConnection.stop() should not complete until after either HttpConnection.start() fails\r\n        // or the onclose callback is invoked. The onclose callback will transition the HubConnection\r\n        // to the disconnected state if need be before HttpConnection.stop() completes.\r\n        return this.connection.stop(error);\r\n    };\r\n    /** Invokes a streaming hub method on the server using the specified name and arguments.\r\n     *\r\n     * @typeparam T The type of the items returned by the server.\r\n     * @param {string} methodName The name of the server method to invoke.\r\n     * @param {any[]} args The arguments used to invoke the server method.\r\n     * @returns {IStreamResult<T>} An object that yields results from the server as they are received.\r\n     */\r\n    HubConnection.prototype.stream = function (methodName) {\r\n        var _this = this;\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        var _a = this.replaceStreamingParams(args), streams = _a[0], streamIds = _a[1];\r\n        var invocationDescriptor = this.createStreamInvocation(methodName, args, streamIds);\r\n        var promiseQueue;\r\n        var subject = new Subject();\r\n        subject.cancelCallback = function () {\r\n            var cancelInvocation = _this.createCancelInvocation(invocationDescriptor.invocationId);\r\n            delete _this.callbacks[invocationDescriptor.invocationId];\r\n            return promiseQueue.then(function () {\r\n                return _this.sendWithProtocol(cancelInvocation);\r\n            });\r\n        };\r\n        this.callbacks[invocationDescriptor.invocationId] = function (invocationEvent, error) {\r\n            if (error) {\r\n                subject.error(error);\r\n                return;\r\n            }\r\n            else if (invocationEvent) {\r\n                // invocationEvent will not be null when an error is not passed to the callback\r\n                if (invocationEvent.type === MessageType.Completion) {\r\n                    if (invocationEvent.error) {\r\n                        subject.error(new Error(invocationEvent.error));\r\n                    }\r\n                    else {\r\n                        subject.complete();\r\n                    }\r\n                }\r\n                else {\r\n                    subject.next((invocationEvent.item));\r\n                }\r\n            }\r\n        };\r\n        promiseQueue = this.sendWithProtocol(invocationDescriptor)\r\n            .catch(function (e) {\r\n            subject.error(e);\r\n            delete _this.callbacks[invocationDescriptor.invocationId];\r\n        });\r\n        this.launchStreams(streams, promiseQueue);\r\n        return subject;\r\n    };\r\n    HubConnection.prototype.sendMessage = function (message) {\r\n        this.resetKeepAliveInterval();\r\n        return this.connection.send(message);\r\n    };\r\n    /**\r\n     * Sends a js object to the server.\r\n     * @param message The js object to serialize and send.\r\n     */\r\n    HubConnection.prototype.sendWithProtocol = function (message) {\r\n        return this.sendMessage(this.protocol.writeMessage(message));\r\n    };\r\n    /** Invokes a hub method on the server using the specified name and arguments. Does not wait for a response from the receiver.\r\n     *\r\n     * The Promise returned by this method resolves when the client has sent the invocation to the server. The server may still\r\n     * be processing the invocation.\r\n     *\r\n     * @param {string} methodName The name of the server method to invoke.\r\n     * @param {any[]} args The arguments used to invoke the server method.\r\n     * @returns {Promise<void>} A Promise that resolves when the invocation has been successfully sent, or rejects with an error.\r\n     */\r\n    HubConnection.prototype.send = function (methodName) {\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        var _a = this.replaceStreamingParams(args), streams = _a[0], streamIds = _a[1];\r\n        var sendPromise = this.sendWithProtocol(this.createInvocation(methodName, args, true, streamIds));\r\n        this.launchStreams(streams, sendPromise);\r\n        return sendPromise;\r\n    };\r\n    /** Invokes a hub method on the server using the specified name and arguments.\r\n     *\r\n     * The Promise returned by this method resolves when the server indicates it has finished invoking the method. When the promise\r\n     * resolves, the server has finished invoking the method. If the server method returns a result, it is produced as the result of\r\n     * resolving the Promise.\r\n     *\r\n     * @typeparam T The expected return type.\r\n     * @param {string} methodName The name of the server method to invoke.\r\n     * @param {any[]} args The arguments used to invoke the server method.\r\n     * @returns {Promise<T>} A Promise that resolves with the result of the server method (if any), or rejects with an error.\r\n     */\r\n    HubConnection.prototype.invoke = function (methodName) {\r\n        var _this = this;\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        var _a = this.replaceStreamingParams(args), streams = _a[0], streamIds = _a[1];\r\n        var invocationDescriptor = this.createInvocation(methodName, args, false, streamIds);\r\n        var p = new Promise(function (resolve, reject) {\r\n            // invocationId will always have a value for a non-blocking invocation\r\n            _this.callbacks[invocationDescriptor.invocationId] = function (invocationEvent, error) {\r\n                if (error) {\r\n                    reject(error);\r\n                    return;\r\n                }\r\n                else if (invocationEvent) {\r\n                    // invocationEvent will not be null when an error is not passed to the callback\r\n                    if (invocationEvent.type === MessageType.Completion) {\r\n                        if (invocationEvent.error) {\r\n                            reject(new Error(invocationEvent.error));\r\n                        }\r\n                        else {\r\n                            resolve(invocationEvent.result);\r\n                        }\r\n                    }\r\n                    else {\r\n                        reject(new Error(\"Unexpected message type: \" + invocationEvent.type));\r\n                    }\r\n                }\r\n            };\r\n            var promiseQueue = _this.sendWithProtocol(invocationDescriptor)\r\n                .catch(function (e) {\r\n                reject(e);\r\n                // invocationId will always have a value for a non-blocking invocation\r\n                delete _this.callbacks[invocationDescriptor.invocationId];\r\n            });\r\n            _this.launchStreams(streams, promiseQueue);\r\n        });\r\n        return p;\r\n    };\r\n    /** Registers a handler that will be invoked when the hub method with the specified method name is invoked.\r\n     *\r\n     * @param {string} methodName The name of the hub method to define.\r\n     * @param {Function} newMethod The handler that will be raised when the hub method is invoked.\r\n     */\r\n    HubConnection.prototype.on = function (methodName, newMethod) {\r\n        if (!methodName || !newMethod) {\r\n            return;\r\n        }\r\n        methodName = methodName.toLowerCase();\r\n        if (!this.methods[methodName]) {\r\n            this.methods[methodName] = [];\r\n        }\r\n        // Preventing adding the same handler multiple times.\r\n        if (this.methods[methodName].indexOf(newMethod) !== -1) {\r\n            return;\r\n        }\r\n        this.methods[methodName].push(newMethod);\r\n    };\r\n    HubConnection.prototype.off = function (methodName, method) {\r\n        if (!methodName) {\r\n            return;\r\n        }\r\n        methodName = methodName.toLowerCase();\r\n        var handlers = this.methods[methodName];\r\n        if (!handlers) {\r\n            return;\r\n        }\r\n        if (method) {\r\n            var removeIdx = handlers.indexOf(method);\r\n            if (removeIdx !== -1) {\r\n                handlers.splice(removeIdx, 1);\r\n                if (handlers.length === 0) {\r\n                    delete this.methods[methodName];\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            delete this.methods[methodName];\r\n        }\r\n    };\r\n    /** Registers a handler that will be invoked when the connection is closed.\r\n     *\r\n     * @param {Function} callback The handler that will be invoked when the connection is closed. Optionally receives a single argument containing the error that caused the connection to close (if any).\r\n     */\r\n    HubConnection.prototype.onclose = function (callback) {\r\n        if (callback) {\r\n            this.closedCallbacks.push(callback);\r\n        }\r\n    };\r\n    /** Registers a handler that will be invoked when the connection starts reconnecting.\r\n     *\r\n     * @param {Function} callback The handler that will be invoked when the connection starts reconnecting. Optionally receives a single argument containing the error that caused the connection to start reconnecting (if any).\r\n     */\r\n    HubConnection.prototype.onreconnecting = function (callback) {\r\n        if (callback) {\r\n            this.reconnectingCallbacks.push(callback);\r\n        }\r\n    };\r\n    /** Registers a handler that will be invoked when the connection successfully reconnects.\r\n     *\r\n     * @param {Function} callback The handler that will be invoked when the connection successfully reconnects.\r\n     */\r\n    HubConnection.prototype.onreconnected = function (callback) {\r\n        if (callback) {\r\n            this.reconnectedCallbacks.push(callback);\r\n        }\r\n    };\r\n    HubConnection.prototype.processIncomingData = function (data) {\r\n        this.cleanupTimeout();\r\n        if (!this.receivedHandshakeResponse) {\r\n            data = this.processHandshakeResponse(data);\r\n            this.receivedHandshakeResponse = true;\r\n        }\r\n        // Data may have all been read when processing handshake response\r\n        if (data) {\r\n            // Parse the messages\r\n            var messages = this.protocol.parseMessages(data, this.logger);\r\n            for (var _i = 0, messages_1 = messages; _i < messages_1.length; _i++) {\r\n                var message = messages_1[_i];\r\n                switch (message.type) {\r\n                    case MessageType.Invocation:\r\n                        this.invokeClientMethod(message);\r\n                        break;\r\n                    case MessageType.StreamItem:\r\n                    case MessageType.Completion:\r\n                        var callback = this.callbacks[message.invocationId];\r\n                        if (callback) {\r\n                            if (message.type === MessageType.Completion) {\r\n                                delete this.callbacks[message.invocationId];\r\n                            }\r\n                            callback(message);\r\n                        }\r\n                        break;\r\n                    case MessageType.Ping:\r\n                        // Don't care about pings\r\n                        break;\r\n                    case MessageType.Close:\r\n                        this.logger.log(LogLevel.Information, \"Close message received from server.\");\r\n                        var error = message.error ? new Error(\"Server returned an error on close: \" + message.error) : undefined;\r\n                        if (message.allowReconnect === true) {\r\n                            // It feels wrong not to await connection.stop() here, but processIncomingData is called as part of an onreceive callback which is not async,\r\n                            // this is already the behavior for serverTimeout(), and HttpConnection.Stop() should catch and log all possible exceptions.\r\n                            // tslint:disable-next-line:no-floating-promises\r\n                            this.connection.stop(error);\r\n                        }\r\n                        else {\r\n                            // We cannot await stopInternal() here, but subsequent calls to stop() will await this if stopInternal() is still ongoing.\r\n                            this.stopPromise = this.stopInternal(error);\r\n                        }\r\n                        break;\r\n                    default:\r\n                        this.logger.log(LogLevel.Warning, \"Invalid message type: \" + message.type + \".\");\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        this.resetTimeoutPeriod();\r\n    };\r\n    HubConnection.prototype.processHandshakeResponse = function (data) {\r\n        var _a;\r\n        var responseMessage;\r\n        var remainingData;\r\n        try {\r\n            _a = this.handshakeProtocol.parseHandshakeResponse(data), remainingData = _a[0], responseMessage = _a[1];\r\n        }\r\n        catch (e) {\r\n            var message = \"Error parsing handshake response: \" + e;\r\n            this.logger.log(LogLevel.Error, message);\r\n            var error = new Error(message);\r\n            this.handshakeRejecter(error);\r\n            throw error;\r\n        }\r\n        if (responseMessage.error) {\r\n            var message = \"Server returned handshake error: \" + responseMessage.error;\r\n            this.logger.log(LogLevel.Error, message);\r\n            var error = new Error(message);\r\n            this.handshakeRejecter(error);\r\n            throw error;\r\n        }\r\n        else {\r\n            this.logger.log(LogLevel.Debug, \"Server handshake complete.\");\r\n        }\r\n        this.handshakeResolver();\r\n        return remainingData;\r\n    };\r\n    HubConnection.prototype.resetKeepAliveInterval = function () {\r\n        var _this = this;\r\n        this.cleanupPingTimer();\r\n        this.pingServerHandle = setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (!(this.connectionState === HubConnectionState.Connected)) return [3 /*break*/, 4];\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        _b.trys.push([1, 3, , 4]);\r\n                        return [4 /*yield*/, this.sendMessage(this.cachedPingMessage)];\r\n                    case 2:\r\n                        _b.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        _a = _b.sent();\r\n                        // We don't care about the error. It should be seen elsewhere in the client.\r\n                        // The connection is probably in a bad or closed state now, cleanup the timer so it stops triggering\r\n                        this.cleanupPingTimer();\r\n                        return [3 /*break*/, 4];\r\n                    case 4: return [2 /*return*/];\r\n                }\r\n            });\r\n        }); }, this.keepAliveIntervalInMilliseconds);\r\n    };\r\n    HubConnection.prototype.resetTimeoutPeriod = function () {\r\n        var _this = this;\r\n        if (!this.connection.features || !this.connection.features.inherentKeepAlive) {\r\n            // Set the timeout timer\r\n            this.timeoutHandle = setTimeout(function () { return _this.serverTimeout(); }, this.serverTimeoutInMilliseconds);\r\n        }\r\n    };\r\n    HubConnection.prototype.serverTimeout = function () {\r\n        // The server hasn't talked to us in a while. It doesn't like us anymore ... :(\r\n        // Terminate the connection, but we don't need to wait on the promise. This could trigger reconnecting.\r\n        // tslint:disable-next-line:no-floating-promises\r\n        this.connection.stop(new Error(\"Server timeout elapsed without receiving a message from the server.\"));\r\n    };\r\n    HubConnection.prototype.invokeClientMethod = function (invocationMessage) {\r\n        var _this = this;\r\n        var methods = this.methods[invocationMessage.target.toLowerCase()];\r\n        if (methods) {\r\n            try {\r\n                methods.forEach(function (m) { return m.apply(_this, invocationMessage.arguments); });\r\n            }\r\n            catch (e) {\r\n                this.logger.log(LogLevel.Error, \"A callback for the method \" + invocationMessage.target.toLowerCase() + \" threw error '\" + e + \"'.\");\r\n            }\r\n            if (invocationMessage.invocationId) {\r\n                // This is not supported in v1. So we return an error to avoid blocking the server waiting for the response.\r\n                var message = \"Server requested a response, which is not supported in this version of the client.\";\r\n                this.logger.log(LogLevel.Error, message);\r\n                // We don't want to wait on the stop itself.\r\n                this.stopPromise = this.stopInternal(new Error(message));\r\n            }\r\n        }\r\n        else {\r\n            this.logger.log(LogLevel.Warning, \"No client method with the name '\" + invocationMessage.target + \"' found.\");\r\n        }\r\n    };\r\n    HubConnection.prototype.connectionClosed = function (error) {\r\n        this.logger.log(LogLevel.Debug, \"HubConnection.connectionClosed(\" + error + \") called while in state \" + this.connectionState + \".\");\r\n        // Triggering this.handshakeRejecter is insufficient because it could already be resolved without the continuation having run yet.\r\n        this.stopDuringStartError = this.stopDuringStartError || error || new Error(\"The underlying connection was closed before the hub handshake could complete.\");\r\n        // If the handshake is in progress, start will be waiting for the handshake promise, so we complete it.\r\n        // If it has already completed, this should just noop.\r\n        if (this.handshakeResolver) {\r\n            this.handshakeResolver();\r\n        }\r\n        this.cancelCallbacksWithError(error || new Error(\"Invocation canceled due to the underlying connection being closed.\"));\r\n        this.cleanupTimeout();\r\n        this.cleanupPingTimer();\r\n        if (this.connectionState === HubConnectionState.Disconnecting) {\r\n            this.completeClose(error);\r\n        }\r\n        else if (this.connectionState === HubConnectionState.Connected && this.reconnectPolicy) {\r\n            // tslint:disable-next-line:no-floating-promises\r\n            this.reconnect(error);\r\n        }\r\n        else if (this.connectionState === HubConnectionState.Connected) {\r\n            this.completeClose(error);\r\n        }\r\n        // If none of the above if conditions were true were called the HubConnection must be in either:\r\n        // 1. The Connecting state in which case the handshakeResolver will complete it and stopDuringStartError will fail it.\r\n        // 2. The Reconnecting state in which case the handshakeResolver will complete it and stopDuringStartError will fail the current reconnect attempt\r\n        //    and potentially continue the reconnect() loop.\r\n        // 3. The Disconnected state in which case we're already done.\r\n    };\r\n    HubConnection.prototype.completeClose = function (error) {\r\n        var _this = this;\r\n        if (this.connectionStarted) {\r\n            this.connectionState = HubConnectionState.Disconnected;\r\n            this.connectionStarted = false;\r\n            try {\r\n                this.closedCallbacks.forEach(function (c) { return c.apply(_this, [error]); });\r\n            }\r\n            catch (e) {\r\n                this.logger.log(LogLevel.Error, \"An onclose callback called with error '\" + error + \"' threw error '\" + e + \"'.\");\r\n            }\r\n        }\r\n    };\r\n    HubConnection.prototype.reconnect = function (error) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var reconnectStartTime, previousReconnectAttempts, retryError, nextRetryDelay, e_4;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        reconnectStartTime = Date.now();\r\n                        previousReconnectAttempts = 0;\r\n                        retryError = error !== undefined ? error : new Error(\"Attempting to reconnect due to a unknown error.\");\r\n                        nextRetryDelay = this.getNextRetryDelay(previousReconnectAttempts++, 0, retryError);\r\n                        if (nextRetryDelay === null) {\r\n                            this.logger.log(LogLevel.Debug, \"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt.\");\r\n                            this.completeClose(error);\r\n                            return [2 /*return*/];\r\n                        }\r\n                        this.connectionState = HubConnectionState.Reconnecting;\r\n                        if (error) {\r\n                            this.logger.log(LogLevel.Information, \"Connection reconnecting because of error '\" + error + \"'.\");\r\n                        }\r\n                        else {\r\n                            this.logger.log(LogLevel.Information, \"Connection reconnecting.\");\r\n                        }\r\n                        if (this.onreconnecting) {\r\n                            try {\r\n                                this.reconnectingCallbacks.forEach(function (c) { return c.apply(_this, [error]); });\r\n                            }\r\n                            catch (e) {\r\n                                this.logger.log(LogLevel.Error, \"An onreconnecting callback called with error '\" + error + \"' threw error '\" + e + \"'.\");\r\n                            }\r\n                            // Exit early if an onreconnecting callback called connection.stop().\r\n                            if (this.connectionState !== HubConnectionState.Reconnecting) {\r\n                                this.logger.log(LogLevel.Debug, \"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.\");\r\n                                return [2 /*return*/];\r\n                            }\r\n                        }\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        if (!(nextRetryDelay !== null)) return [3 /*break*/, 7];\r\n                        this.logger.log(LogLevel.Information, \"Reconnect attempt number \" + previousReconnectAttempts + \" will start in \" + nextRetryDelay + \" ms.\");\r\n                        return [4 /*yield*/, new Promise(function (resolve) {\r\n                                _this.reconnectDelayHandle = setTimeout(resolve, nextRetryDelay);\r\n                            })];\r\n                    case 2:\r\n                        _a.sent();\r\n                        this.reconnectDelayHandle = undefined;\r\n                        if (this.connectionState !== HubConnectionState.Reconnecting) {\r\n                            this.logger.log(LogLevel.Debug, \"Connection left the reconnecting state during reconnect delay. Done reconnecting.\");\r\n                            return [2 /*return*/];\r\n                        }\r\n                        _a.label = 3;\r\n                    case 3:\r\n                        _a.trys.push([3, 5, , 6]);\r\n                        return [4 /*yield*/, this.startInternal()];\r\n                    case 4:\r\n                        _a.sent();\r\n                        this.connectionState = HubConnectionState.Connected;\r\n                        this.logger.log(LogLevel.Information, \"HubConnection reconnected successfully.\");\r\n                        if (this.onreconnected) {\r\n                            try {\r\n                                this.reconnectedCallbacks.forEach(function (c) { return c.apply(_this, [_this.connection.connectionId]); });\r\n                            }\r\n                            catch (e) {\r\n                                this.logger.log(LogLevel.Error, \"An onreconnected callback called with connectionId '\" + this.connection.connectionId + \"; threw error '\" + e + \"'.\");\r\n                            }\r\n                        }\r\n                        return [2 /*return*/];\r\n                    case 5:\r\n                        e_4 = _a.sent();\r\n                        this.logger.log(LogLevel.Information, \"Reconnect attempt failed because of error '\" + e_4 + \"'.\");\r\n                        if (this.connectionState !== HubConnectionState.Reconnecting) {\r\n                            this.logger.log(LogLevel.Debug, \"Connection left the reconnecting state during reconnect attempt. Done reconnecting.\");\r\n                            return [2 /*return*/];\r\n                        }\r\n                        retryError = e_4 instanceof Error ? e_4 : new Error(e_4.toString());\r\n                        nextRetryDelay = this.getNextRetryDelay(previousReconnectAttempts++, Date.now() - reconnectStartTime, retryError);\r\n                        return [3 /*break*/, 6];\r\n                    case 6: return [3 /*break*/, 1];\r\n                    case 7:\r\n                        this.logger.log(LogLevel.Information, \"Reconnect retries have been exhausted after \" + (Date.now() - reconnectStartTime) + \" ms and \" + previousReconnectAttempts + \" failed attempts. Connection disconnecting.\");\r\n                        this.completeClose();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    HubConnection.prototype.getNextRetryDelay = function (previousRetryCount, elapsedMilliseconds, retryReason) {\r\n        try {\r\n            return this.reconnectPolicy.nextRetryDelayInMilliseconds({\r\n                elapsedMilliseconds: elapsedMilliseconds,\r\n                previousRetryCount: previousRetryCount,\r\n                retryReason: retryReason,\r\n            });\r\n        }\r\n        catch (e) {\r\n            this.logger.log(LogLevel.Error, \"IRetryPolicy.nextRetryDelayInMilliseconds(\" + previousRetryCount + \", \" + elapsedMilliseconds + \") threw error '\" + e + \"'.\");\r\n            return null;\r\n        }\r\n    };\r\n    HubConnection.prototype.cancelCallbacksWithError = function (error) {\r\n        var callbacks = this.callbacks;\r\n        this.callbacks = {};\r\n        Object.keys(callbacks)\r\n            .forEach(function (key) {\r\n            var callback = callbacks[key];\r\n            callback(null, error);\r\n        });\r\n    };\r\n    HubConnection.prototype.cleanupPingTimer = function () {\r\n        if (this.pingServerHandle) {\r\n            clearTimeout(this.pingServerHandle);\r\n        }\r\n    };\r\n    HubConnection.prototype.cleanupTimeout = function () {\r\n        if (this.timeoutHandle) {\r\n            clearTimeout(this.timeoutHandle);\r\n        }\r\n    };\r\n    HubConnection.prototype.createInvocation = function (methodName, args, nonblocking, streamIds) {\r\n        if (nonblocking) {\r\n            return {\r\n                arguments: args,\r\n                streamIds: streamIds,\r\n                target: methodName,\r\n                type: MessageType.Invocation,\r\n            };\r\n        }\r\n        else {\r\n            var invocationId = this.invocationId;\r\n            this.invocationId++;\r\n            return {\r\n                arguments: args,\r\n                invocationId: invocationId.toString(),\r\n                streamIds: streamIds,\r\n                target: methodName,\r\n                type: MessageType.Invocation,\r\n            };\r\n        }\r\n    };\r\n    HubConnection.prototype.launchStreams = function (streams, promiseQueue) {\r\n        var _this = this;\r\n        if (streams.length === 0) {\r\n            return;\r\n        }\r\n        // Synchronize stream data so they arrive in-order on the server\r\n        if (!promiseQueue) {\r\n            promiseQueue = Promise.resolve();\r\n        }\r\n        var _loop_1 = function (streamId) {\r\n            streams[streamId].subscribe({\r\n                complete: function () {\r\n                    promiseQueue = promiseQueue.then(function () { return _this.sendWithProtocol(_this.createCompletionMessage(streamId)); });\r\n                },\r\n                error: function (err) {\r\n                    var message;\r\n                    if (err instanceof Error) {\r\n                        message = err.message;\r\n                    }\r\n                    else if (err && err.toString) {\r\n                        message = err.toString();\r\n                    }\r\n                    else {\r\n                        message = \"Unknown error\";\r\n                    }\r\n                    promiseQueue = promiseQueue.then(function () { return _this.sendWithProtocol(_this.createCompletionMessage(streamId, message)); });\r\n                },\r\n                next: function (item) {\r\n                    promiseQueue = promiseQueue.then(function () { return _this.sendWithProtocol(_this.createStreamItemMessage(streamId, item)); });\r\n                },\r\n            });\r\n        };\r\n        // We want to iterate over the keys, since the keys are the stream ids\r\n        // tslint:disable-next-line:forin\r\n        for (var streamId in streams) {\r\n            _loop_1(streamId);\r\n        }\r\n    };\r\n    HubConnection.prototype.replaceStreamingParams = function (args) {\r\n        var streams = [];\r\n        var streamIds = [];\r\n        for (var i = 0; i < args.length; i++) {\r\n            var argument = args[i];\r\n            if (this.isObservable(argument)) {\r\n                var streamId = this.invocationId;\r\n                this.invocationId++;\r\n                // Store the stream for later use\r\n                streams[streamId] = argument;\r\n                streamIds.push(streamId.toString());\r\n                // remove stream from args\r\n                args.splice(i, 1);\r\n            }\r\n        }\r\n        return [streams, streamIds];\r\n    };\r\n    HubConnection.prototype.isObservable = function (arg) {\r\n        // This allows other stream implementations to just work (like rxjs)\r\n        return arg && arg.subscribe && typeof arg.subscribe === \"function\";\r\n    };\r\n    HubConnection.prototype.createStreamInvocation = function (methodName, args, streamIds) {\r\n        var invocationId = this.invocationId;\r\n        this.invocationId++;\r\n        return {\r\n            arguments: args,\r\n            invocationId: invocationId.toString(),\r\n            streamIds: streamIds,\r\n            target: methodName,\r\n            type: MessageType.StreamInvocation,\r\n        };\r\n    };\r\n    HubConnection.prototype.createCancelInvocation = function (id) {\r\n        return {\r\n            invocationId: id,\r\n            type: MessageType.CancelInvocation,\r\n        };\r\n    };\r\n    HubConnection.prototype.createStreamItemMessage = function (id, item) {\r\n        return {\r\n            invocationId: id,\r\n            item: item,\r\n            type: MessageType.StreamItem,\r\n        };\r\n    };\r\n    HubConnection.prototype.createCompletionMessage = function (id, error, result) {\r\n        if (error) {\r\n            return {\r\n                error: error,\r\n                invocationId: id,\r\n                type: MessageType.Completion,\r\n            };\r\n        }\r\n        return {\r\n            invocationId: id,\r\n            result: result,\r\n            type: MessageType.Completion,\r\n        };\r\n    };\r\n    return HubConnection;\r\n}());\r\nexport { HubConnection };\r\n//# sourceMappingURL=HubConnection.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\n// This will be treated as a bit flag in the future, so we keep it using power-of-two values.\r\n/** Specifies a specific HTTP transport type. */\r\nexport var HttpTransportType;\r\n(function (HttpTransportType) {\r\n    /** Specifies no transport preference. */\r\n    HttpTransportType[HttpTransportType[\"None\"] = 0] = \"None\";\r\n    /** Specifies the WebSockets transport. */\r\n    HttpTransportType[HttpTransportType[\"WebSockets\"] = 1] = \"WebSockets\";\r\n    /** Specifies the Server-Sent Events transport. */\r\n    HttpTransportType[HttpTransportType[\"ServerSentEvents\"] = 2] = \"ServerSentEvents\";\r\n    /** Specifies the Long Polling transport. */\r\n    HttpTransportType[HttpTransportType[\"LongPolling\"] = 4] = \"LongPolling\";\r\n})(HttpTransportType || (HttpTransportType = {}));\r\n/** Specifies the transfer format for a connection. */\r\nexport var TransferFormat;\r\n(function (TransferFormat) {\r\n    /** Specifies that only text data will be transmitted over the connection. */\r\n    TransferFormat[TransferFormat[\"Text\"] = 1] = \"Text\";\r\n    /** Specifies that binary data will be transmitted over the connection. */\r\n    TransferFormat[TransferFormat[\"Binary\"] = 2] = \"Binary\";\r\n})(TransferFormat || (TransferFormat = {}));\r\n//# sourceMappingURL=ITransport.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\n// 0, 2, 10, 30 second delays before reconnect attempts.\r\nvar DEFAULT_RETRY_DELAYS_IN_MILLISECONDS = [0, 2000, 10000, 30000, null];\r\n/** @private */\r\nvar DefaultReconnectPolicy = /** @class */ (function () {\r\n    function DefaultReconnectPolicy(retryDelays) {\r\n        this.retryDelays = retryDelays !== undefined ? retryDelays.concat([null]) : DEFAULT_RETRY_DELAYS_IN_MILLISECONDS;\r\n    }\r\n    DefaultReconnectPolicy.prototype.nextRetryDelayInMilliseconds = function (retryContext) {\r\n        return this.retryDelays[retryContext.previousRetryCount];\r\n    };\r\n    return DefaultReconnectPolicy;\r\n}());\r\nexport { DefaultReconnectPolicy };\r\n//# sourceMappingURL=DefaultReconnectPolicy.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\n// Rough polyfill of https://developer.mozilla.org/en-US/docs/Web/API/AbortController\r\n// We don't actually ever use the API being polyfilled, we always use the polyfill because\r\n// it's a very new API right now.\r\n// Not exported from index.\r\n/** @private */\r\nvar AbortController = /** @class */ (function () {\r\n    function AbortController() {\r\n        this.isAborted = false;\r\n        this.onabort = null;\r\n    }\r\n    AbortController.prototype.abort = function () {\r\n        if (!this.isAborted) {\r\n            this.isAborted = true;\r\n            if (this.onabort) {\r\n                this.onabort();\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(AbortController.prototype, \"signal\", {\r\n        get: function () {\r\n            return this;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AbortController.prototype, \"aborted\", {\r\n        get: function () {\r\n            return this.isAborted;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return AbortController;\r\n}());\r\nexport { AbortController };\r\n//# sourceMappingURL=AbortController.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { AbortController } from \"./AbortController\";\r\nimport { HttpError, TimeoutError } from \"./Errors\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { TransferFormat } from \"./ITransport\";\r\nimport { Arg, getDataDetail, sendMessage } from \"./Utils\";\r\n// Not exported from 'index', this type is internal.\r\n/** @private */\r\nvar LongPollingTransport = /** @class */ (function () {\r\n    function LongPollingTransport(httpClient, accessTokenFactory, logger, logMessageContent) {\r\n        this.httpClient = httpClient;\r\n        this.accessTokenFactory = accessTokenFactory;\r\n        this.logger = logger;\r\n        this.pollAbort = new AbortController();\r\n        this.logMessageContent = logMessageContent;\r\n        this.running = false;\r\n        this.onreceive = null;\r\n        this.onclose = null;\r\n    }\r\n    Object.defineProperty(LongPollingTransport.prototype, \"pollAborted\", {\r\n        // This is an internal type, not exported from 'index' so this is really just internal.\r\n        get: function () {\r\n            return this.pollAbort.aborted;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LongPollingTransport.prototype.connect = function (url, transferFormat) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var pollOptions, token, pollUrl, response;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        Arg.isRequired(url, \"url\");\r\n                        Arg.isRequired(transferFormat, \"transferFormat\");\r\n                        Arg.isIn(transferFormat, TransferFormat, \"transferFormat\");\r\n                        this.url = url;\r\n                        this.logger.log(LogLevel.Trace, \"(LongPolling transport) Connecting.\");\r\n                        // Allow binary format on Node and Browsers that support binary content (indicated by the presence of responseType property)\r\n                        if (transferFormat === TransferFormat.Binary &&\r\n                            (typeof XMLHttpRequest !== \"undefined\" && typeof new XMLHttpRequest().responseType !== \"string\")) {\r\n                            throw new Error(\"Binary protocols over XmlHttpRequest not implementing advanced features are not supported.\");\r\n                        }\r\n                        pollOptions = {\r\n                            abortSignal: this.pollAbort.signal,\r\n                            headers: {},\r\n                            timeout: 100000,\r\n                        };\r\n                        if (transferFormat === TransferFormat.Binary) {\r\n                            pollOptions.responseType = \"arraybuffer\";\r\n                        }\r\n                        return [4 /*yield*/, this.getAccessToken()];\r\n                    case 1:\r\n                        token = _a.sent();\r\n                        this.updateHeaderToken(pollOptions, token);\r\n                        pollUrl = url + \"&_=\" + Date.now();\r\n                        this.logger.log(LogLevel.Trace, \"(LongPolling transport) polling: \" + pollUrl + \".\");\r\n                        return [4 /*yield*/, this.httpClient.get(pollUrl, pollOptions)];\r\n                    case 2:\r\n                        response = _a.sent();\r\n                        if (response.statusCode !== 200) {\r\n                            this.logger.log(LogLevel.Error, \"(LongPolling transport) Unexpected response code: \" + response.statusCode + \".\");\r\n                            // Mark running as false so that the poll immediately ends and runs the close logic\r\n                            this.closeError = new HttpError(response.statusText || \"\", response.statusCode);\r\n                            this.running = false;\r\n                        }\r\n                        else {\r\n                            this.running = true;\r\n                        }\r\n                        this.receiving = this.poll(this.url, pollOptions);\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    LongPollingTransport.prototype.getAccessToken = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!this.accessTokenFactory) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, this.accessTokenFactory()];\r\n                    case 1: return [2 /*return*/, _a.sent()];\r\n                    case 2: return [2 /*return*/, null];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    LongPollingTransport.prototype.updateHeaderToken = function (request, token) {\r\n        if (!request.headers) {\r\n            request.headers = {};\r\n        }\r\n        if (token) {\r\n            // tslint:disable-next-line:no-string-literal\r\n            request.headers[\"Authorization\"] = \"Bearer \" + token;\r\n            return;\r\n        }\r\n        // tslint:disable-next-line:no-string-literal\r\n        if (request.headers[\"Authorization\"]) {\r\n            // tslint:disable-next-line:no-string-literal\r\n            delete request.headers[\"Authorization\"];\r\n        }\r\n    };\r\n    LongPollingTransport.prototype.poll = function (url, pollOptions) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var token, pollUrl, response, e_1;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        _a.trys.push([0, , 8, 9]);\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        if (!this.running) return [3 /*break*/, 7];\r\n                        return [4 /*yield*/, this.getAccessToken()];\r\n                    case 2:\r\n                        token = _a.sent();\r\n                        this.updateHeaderToken(pollOptions, token);\r\n                        _a.label = 3;\r\n                    case 3:\r\n                        _a.trys.push([3, 5, , 6]);\r\n                        pollUrl = url + \"&_=\" + Date.now();\r\n                        this.logger.log(LogLevel.Trace, \"(LongPolling transport) polling: \" + pollUrl + \".\");\r\n                        return [4 /*yield*/, this.httpClient.get(pollUrl, pollOptions)];\r\n                    case 4:\r\n                        response = _a.sent();\r\n                        if (response.statusCode === 204) {\r\n                            this.logger.log(LogLevel.Information, \"(LongPolling transport) Poll terminated by server.\");\r\n                            this.running = false;\r\n                        }\r\n                        else if (response.statusCode !== 200) {\r\n                            this.logger.log(LogLevel.Error, \"(LongPolling transport) Unexpected response code: \" + response.statusCode + \".\");\r\n                            // Unexpected status code\r\n                            this.closeError = new HttpError(response.statusText || \"\", response.statusCode);\r\n                            this.running = false;\r\n                        }\r\n                        else {\r\n                            // Process the response\r\n                            if (response.content) {\r\n                                this.logger.log(LogLevel.Trace, \"(LongPolling transport) data received. \" + getDataDetail(response.content, this.logMessageContent) + \".\");\r\n                                if (this.onreceive) {\r\n                                    this.onreceive(response.content);\r\n                                }\r\n                            }\r\n                            else {\r\n                                // This is another way timeout manifest.\r\n                                this.logger.log(LogLevel.Trace, \"(LongPolling transport) Poll timed out, reissuing.\");\r\n                            }\r\n                        }\r\n                        return [3 /*break*/, 6];\r\n                    case 5:\r\n                        e_1 = _a.sent();\r\n                        if (!this.running) {\r\n                            // Log but disregard errors that occur after stopping\r\n                            this.logger.log(LogLevel.Trace, \"(LongPolling transport) Poll errored after shutdown: \" + e_1.message);\r\n                        }\r\n                        else {\r\n                            if (e_1 instanceof TimeoutError) {\r\n                                // Ignore timeouts and reissue the poll.\r\n                                this.logger.log(LogLevel.Trace, \"(LongPolling transport) Poll timed out, reissuing.\");\r\n                            }\r\n                            else {\r\n                                // Close the connection with the error as the result.\r\n                                this.closeError = e_1;\r\n                                this.running = false;\r\n                            }\r\n                        }\r\n                        return [3 /*break*/, 6];\r\n                    case 6: return [3 /*break*/, 1];\r\n                    case 7: return [3 /*break*/, 9];\r\n                    case 8:\r\n                        this.logger.log(LogLevel.Trace, \"(LongPolling transport) Polling complete.\");\r\n                        // We will reach here with pollAborted==false when the server returned a response causing the transport to stop.\r\n                        // If pollAborted==true then client initiated the stop and the stop method will raise the close event after DELETE is sent.\r\n                        if (!this.pollAborted) {\r\n                            this.raiseOnClose();\r\n                        }\r\n                        return [7 /*endfinally*/];\r\n                    case 9: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    LongPollingTransport.prototype.send = function (data) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                if (!this.running) {\r\n                    return [2 /*return*/, Promise.reject(new Error(\"Cannot send until the transport is connected\"))];\r\n                }\r\n                return [2 /*return*/, sendMessage(this.logger, \"LongPolling\", this.httpClient, this.url, this.accessTokenFactory, data, this.logMessageContent)];\r\n            });\r\n        });\r\n    };\r\n    LongPollingTransport.prototype.stop = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var deleteOptions, token;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this.logger.log(LogLevel.Trace, \"(LongPolling transport) Stopping polling.\");\r\n                        // Tell receiving loop to stop, abort any current request, and then wait for it to finish\r\n                        this.running = false;\r\n                        this.pollAbort.abort();\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        _a.trys.push([1, , 5, 6]);\r\n                        return [4 /*yield*/, this.receiving];\r\n                    case 2:\r\n                        _a.sent();\r\n                        // Send DELETE to clean up long polling on the server\r\n                        this.logger.log(LogLevel.Trace, \"(LongPolling transport) sending DELETE request to \" + this.url + \".\");\r\n                        deleteOptions = {\r\n                            headers: {},\r\n                        };\r\n                        return [4 /*yield*/, this.getAccessToken()];\r\n                    case 3:\r\n                        token = _a.sent();\r\n                        this.updateHeaderToken(deleteOptions, token);\r\n                        return [4 /*yield*/, this.httpClient.delete(this.url, deleteOptions)];\r\n                    case 4:\r\n                        _a.sent();\r\n                        this.logger.log(LogLevel.Trace, \"(LongPolling transport) DELETE request sent.\");\r\n                        return [3 /*break*/, 6];\r\n                    case 5:\r\n                        this.logger.log(LogLevel.Trace, \"(LongPolling transport) Stop finished.\");\r\n                        // Raise close event here instead of in polling\r\n                        // It needs to happen after the DELETE request is sent\r\n                        this.raiseOnClose();\r\n                        return [7 /*endfinally*/];\r\n                    case 6: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    LongPollingTransport.prototype.raiseOnClose = function () {\r\n        if (this.onclose) {\r\n            var logMessage = \"(LongPolling transport) Firing onclose event.\";\r\n            if (this.closeError) {\r\n                logMessage += \" Error: \" + this.closeError;\r\n            }\r\n            this.logger.log(LogLevel.Trace, logMessage);\r\n            this.onclose(this.closeError);\r\n        }\r\n    };\r\n    return LongPollingTransport;\r\n}());\r\nexport { LongPollingTransport };\r\n//# sourceMappingURL=LongPollingTransport.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { TransferFormat } from \"./ITransport\";\r\nimport { Arg, getDataDetail, Platform, sendMessage } from \"./Utils\";\r\n/** @private */\r\nvar ServerSentEventsTransport = /** @class */ (function () {\r\n    function ServerSentEventsTransport(httpClient, accessTokenFactory, logger, logMessageContent, eventSourceConstructor) {\r\n        this.httpClient = httpClient;\r\n        this.accessTokenFactory = accessTokenFactory;\r\n        this.logger = logger;\r\n        this.logMessageContent = logMessageContent;\r\n        this.eventSourceConstructor = eventSourceConstructor;\r\n        this.onreceive = null;\r\n        this.onclose = null;\r\n    }\r\n    ServerSentEventsTransport.prototype.connect = function (url, transferFormat) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var token;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        Arg.isRequired(url, \"url\");\r\n                        Arg.isRequired(transferFormat, \"transferFormat\");\r\n                        Arg.isIn(transferFormat, TransferFormat, \"transferFormat\");\r\n                        this.logger.log(LogLevel.Trace, \"(SSE transport) Connecting.\");\r\n                        // set url before accessTokenFactory because this.url is only for send and we set the auth header instead of the query string for send\r\n                        this.url = url;\r\n                        if (!this.accessTokenFactory) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, this.accessTokenFactory()];\r\n                    case 1:\r\n                        token = _a.sent();\r\n                        if (token) {\r\n                            url += (url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + (\"access_token=\" + encodeURIComponent(token));\r\n                        }\r\n                        _a.label = 2;\r\n                    case 2: return [2 /*return*/, new Promise(function (resolve, reject) {\r\n                            var opened = false;\r\n                            if (transferFormat !== TransferFormat.Text) {\r\n                                reject(new Error(\"The Server-Sent Events transport only supports the 'Text' transfer format\"));\r\n                                return;\r\n                            }\r\n                            var eventSource;\r\n                            if (Platform.isBrowser || Platform.isWebWorker) {\r\n                                eventSource = new _this.eventSourceConstructor(url, { withCredentials: true });\r\n                            }\r\n                            else {\r\n                                // Non-browser passes cookies via the dictionary\r\n                                var cookies = _this.httpClient.getCookieString(url);\r\n                                eventSource = new _this.eventSourceConstructor(url, { withCredentials: true, headers: { Cookie: cookies } });\r\n                            }\r\n                            try {\r\n                                eventSource.onmessage = function (e) {\r\n                                    if (_this.onreceive) {\r\n                                        try {\r\n                                            _this.logger.log(LogLevel.Trace, \"(SSE transport) data received. \" + getDataDetail(e.data, _this.logMessageContent) + \".\");\r\n                                            _this.onreceive(e.data);\r\n                                        }\r\n                                        catch (error) {\r\n                                            _this.close(error);\r\n                                            return;\r\n                                        }\r\n                                    }\r\n                                };\r\n                                eventSource.onerror = function (e) {\r\n                                    var error = new Error(e.data || \"Error occurred\");\r\n                                    if (opened) {\r\n                                        _this.close(error);\r\n                                    }\r\n                                    else {\r\n                                        reject(error);\r\n                                    }\r\n                                };\r\n                                eventSource.onopen = function () {\r\n                                    _this.logger.log(LogLevel.Information, \"SSE connected to \" + _this.url);\r\n                                    _this.eventSource = eventSource;\r\n                                    opened = true;\r\n                                    resolve();\r\n                                };\r\n                            }\r\n                            catch (e) {\r\n                                reject(e);\r\n                                return;\r\n                            }\r\n                        })];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ServerSentEventsTransport.prototype.send = function (data) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                if (!this.eventSource) {\r\n                    return [2 /*return*/, Promise.reject(new Error(\"Cannot send until the transport is connected\"))];\r\n                }\r\n                return [2 /*return*/, sendMessage(this.logger, \"SSE\", this.httpClient, this.url, this.accessTokenFactory, data, this.logMessageContent)];\r\n            });\r\n        });\r\n    };\r\n    ServerSentEventsTransport.prototype.stop = function () {\r\n        this.close();\r\n        return Promise.resolve();\r\n    };\r\n    ServerSentEventsTransport.prototype.close = function (e) {\r\n        if (this.eventSource) {\r\n            this.eventSource.close();\r\n            this.eventSource = undefined;\r\n            if (this.onclose) {\r\n                this.onclose(e);\r\n            }\r\n        }\r\n    };\r\n    return ServerSentEventsTransport;\r\n}());\r\nexport { ServerSentEventsTransport };\r\n//# sourceMappingURL=ServerSentEventsTransport.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { TransferFormat } from \"./ITransport\";\r\nimport { Arg, getDataDetail, Platform } from \"./Utils\";\r\n/** @private */\r\nvar WebSocketTransport = /** @class */ (function () {\r\n    function WebSocketTransport(httpClient, accessTokenFactory, logger, logMessageContent, webSocketConstructor) {\r\n        this.logger = logger;\r\n        this.accessTokenFactory = accessTokenFactory;\r\n        this.logMessageContent = logMessageContent;\r\n        this.webSocketConstructor = webSocketConstructor;\r\n        this.httpClient = httpClient;\r\n        this.onreceive = null;\r\n        this.onclose = null;\r\n    }\r\n    WebSocketTransport.prototype.connect = function (url, transferFormat) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var token;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        Arg.isRequired(url, \"url\");\r\n                        Arg.isRequired(transferFormat, \"transferFormat\");\r\n                        Arg.isIn(transferFormat, TransferFormat, \"transferFormat\");\r\n                        this.logger.log(LogLevel.Trace, \"(WebSockets transport) Connecting.\");\r\n                        if (!this.accessTokenFactory) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, this.accessTokenFactory()];\r\n                    case 1:\r\n                        token = _a.sent();\r\n                        if (token) {\r\n                            url += (url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + (\"access_token=\" + encodeURIComponent(token));\r\n                        }\r\n                        _a.label = 2;\r\n                    case 2: return [2 /*return*/, new Promise(function (resolve, reject) {\r\n                            url = url.replace(/^http/, \"ws\");\r\n                            var webSocket;\r\n                            var cookies = _this.httpClient.getCookieString(url);\r\n                            var opened = false;\r\n                            if (Platform.isNode && cookies) {\r\n                                // Only pass cookies when in non-browser environments\r\n                                webSocket = new _this.webSocketConstructor(url, undefined, {\r\n                                    headers: {\r\n                                        Cookie: \"\" + cookies,\r\n                                    },\r\n                                });\r\n                            }\r\n                            if (!webSocket) {\r\n                                // Chrome is not happy with passing 'undefined' as protocol\r\n                                webSocket = new _this.webSocketConstructor(url);\r\n                            }\r\n                            if (transferFormat === TransferFormat.Binary) {\r\n                                webSocket.binaryType = \"arraybuffer\";\r\n                            }\r\n                            // tslint:disable-next-line:variable-name\r\n                            webSocket.onopen = function (_event) {\r\n                                _this.logger.log(LogLevel.Information, \"WebSocket connected to \" + url + \".\");\r\n                                _this.webSocket = webSocket;\r\n                                opened = true;\r\n                                resolve();\r\n                            };\r\n                            webSocket.onerror = function (event) {\r\n                                var error = null;\r\n                                // ErrorEvent is a browser only type we need to check if the type exists before using it\r\n                                if (typeof ErrorEvent !== \"undefined\" && event instanceof ErrorEvent) {\r\n                                    error = event.error;\r\n                                }\r\n                                else {\r\n                                    error = new Error(\"There was an error with the transport.\");\r\n                                }\r\n                                reject(error);\r\n                            };\r\n                            webSocket.onmessage = function (message) {\r\n                                _this.logger.log(LogLevel.Trace, \"(WebSockets transport) data received. \" + getDataDetail(message.data, _this.logMessageContent) + \".\");\r\n                                if (_this.onreceive) {\r\n                                    _this.onreceive(message.data);\r\n                                }\r\n                            };\r\n                            webSocket.onclose = function (event) {\r\n                                // Don't call close handler if connection was never established\r\n                                // We'll reject the connect call instead\r\n                                if (opened) {\r\n                                    _this.close(event);\r\n                                }\r\n                                else {\r\n                                    var error = null;\r\n                                    // ErrorEvent is a browser only type we need to check if the type exists before using it\r\n                                    if (typeof ErrorEvent !== \"undefined\" && event instanceof ErrorEvent) {\r\n                                        error = event.error;\r\n                                    }\r\n                                    else {\r\n                                        error = new Error(\"There was an error with the transport.\");\r\n                                    }\r\n                                    reject(error);\r\n                                }\r\n                            };\r\n                        })];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    WebSocketTransport.prototype.send = function (data) {\r\n        if (this.webSocket && this.webSocket.readyState === this.webSocketConstructor.OPEN) {\r\n            this.logger.log(LogLevel.Trace, \"(WebSockets transport) sending data. \" + getDataDetail(data, this.logMessageContent) + \".\");\r\n            this.webSocket.send(data);\r\n            return Promise.resolve();\r\n        }\r\n        return Promise.reject(\"WebSocket is not in the OPEN state\");\r\n    };\r\n    WebSocketTransport.prototype.stop = function () {\r\n        if (this.webSocket) {\r\n            // Manually invoke onclose callback inline so we know the HttpConnection was closed properly before returning\r\n            // This also solves an issue where websocket.onclose could take 18+ seconds to trigger during network disconnects\r\n            this.close(undefined);\r\n        }\r\n        return Promise.resolve();\r\n    };\r\n    WebSocketTransport.prototype.close = function (event) {\r\n        // webSocket will be null if the transport did not start successfully\r\n        if (this.webSocket) {\r\n            // Clear websocket handlers because we are considering the socket closed now\r\n            this.webSocket.onclose = function () { };\r\n            this.webSocket.onmessage = function () { };\r\n            this.webSocket.onerror = function () { };\r\n            this.webSocket.close();\r\n            this.webSocket = undefined;\r\n        }\r\n        this.logger.log(LogLevel.Trace, \"(WebSockets transport) socket closed.\");\r\n        if (this.onclose) {\r\n            if (event && (event.wasClean === false || event.code !== 1000)) {\r\n                this.onclose(new Error(\"WebSocket closed with status code: \" + event.code + \" (\" + event.reason + \").\"));\r\n            }\r\n            else {\r\n                this.onclose();\r\n            }\r\n        }\r\n    };\r\n    return WebSocketTransport;\r\n}());\r\nexport { WebSocketTransport };\r\n//# sourceMappingURL=WebSocketTransport.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { DefaultHttpClient } from \"./DefaultHttpClient\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { HttpTransportType, TransferFormat } from \"./ITransport\";\r\nimport { LongPollingTransport } from \"./LongPollingTransport\";\r\nimport { ServerSentEventsTransport } from \"./ServerSentEventsTransport\";\r\nimport { Arg, createLogger, Platform } from \"./Utils\";\r\nimport { WebSocketTransport } from \"./WebSocketTransport\";\r\nvar MAX_REDIRECTS = 100;\r\nvar WebSocketModule = null;\r\nvar EventSourceModule = null;\r\nif (Platform.isNode && typeof require !== \"undefined\") {\r\n    // In order to ignore the dynamic require in webpack builds we need to do this magic\r\n    // @ts-ignore: TS doesn't know about these names\r\n    var requireFunc = typeof __webpack_require__ === \"function\" ? __non_webpack_require__ : require;\r\n    WebSocketModule = requireFunc(\"ws\");\r\n    EventSourceModule = requireFunc(\"eventsource\");\r\n}\r\n/** @private */\r\nvar HttpConnection = /** @class */ (function () {\r\n    function HttpConnection(url, options) {\r\n        if (options === void 0) { options = {}; }\r\n        this.features = {};\r\n        this.negotiateVersion = 1;\r\n        Arg.isRequired(url, \"url\");\r\n        this.logger = createLogger(options.logger);\r\n        this.baseUrl = this.resolveUrl(url);\r\n        options = options || {};\r\n        options.logMessageContent = options.logMessageContent || false;\r\n        if (!Platform.isNode && typeof WebSocket !== \"undefined\" && !options.WebSocket) {\r\n            options.WebSocket = WebSocket;\r\n        }\r\n        else if (Platform.isNode && !options.WebSocket) {\r\n            if (WebSocketModule) {\r\n                options.WebSocket = WebSocketModule;\r\n            }\r\n        }\r\n        if (!Platform.isNode && typeof EventSource !== \"undefined\" && !options.EventSource) {\r\n            options.EventSource = EventSource;\r\n        }\r\n        else if (Platform.isNode && !options.EventSource) {\r\n            if (typeof EventSourceModule !== \"undefined\") {\r\n                options.EventSource = EventSourceModule;\r\n            }\r\n        }\r\n        this.httpClient = options.httpClient || new DefaultHttpClient(this.logger);\r\n        this.connectionState = \"Disconnected\" /* Disconnected */;\r\n        this.connectionStarted = false;\r\n        this.options = options;\r\n        this.onreceive = null;\r\n        this.onclose = null;\r\n    }\r\n    HttpConnection.prototype.start = function (transferFormat) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var message, message;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        transferFormat = transferFormat || TransferFormat.Binary;\r\n                        Arg.isIn(transferFormat, TransferFormat, \"transferFormat\");\r\n                        this.logger.log(LogLevel.Debug, \"Starting connection with transfer format '\" + TransferFormat[transferFormat] + \"'.\");\r\n                        if (this.connectionState !== \"Disconnected\" /* Disconnected */) {\r\n                            return [2 /*return*/, Promise.reject(new Error(\"Cannot start an HttpConnection that is not in the 'Disconnected' state.\"))];\r\n                        }\r\n                        this.connectionState = \"Connecting \" /* Connecting */;\r\n                        this.startInternalPromise = this.startInternal(transferFormat);\r\n                        return [4 /*yield*/, this.startInternalPromise];\r\n                    case 1:\r\n                        _a.sent();\r\n                        if (!(this.connectionState === \"Disconnecting\" /* Disconnecting */)) return [3 /*break*/, 3];\r\n                        message = \"Failed to start the HttpConnection before stop() was called.\";\r\n                        this.logger.log(LogLevel.Error, message);\r\n                        // We cannot await stopPromise inside startInternal since stopInternal awaits the startInternalPromise.\r\n                        return [4 /*yield*/, this.stopPromise];\r\n                    case 2:\r\n                        // We cannot await stopPromise inside startInternal since stopInternal awaits the startInternalPromise.\r\n                        _a.sent();\r\n                        return [2 /*return*/, Promise.reject(new Error(message))];\r\n                    case 3:\r\n                        if (this.connectionState !== \"Connected\" /* Connected */) {\r\n                            message = \"HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!\";\r\n                            this.logger.log(LogLevel.Error, message);\r\n                            return [2 /*return*/, Promise.reject(new Error(message))];\r\n                        }\r\n                        _a.label = 4;\r\n                    case 4:\r\n                        this.connectionStarted = true;\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    HttpConnection.prototype.send = function (data) {\r\n        if (this.connectionState !== \"Connected\" /* Connected */) {\r\n            return Promise.reject(new Error(\"Cannot send data if the connection is not in the 'Connected' State.\"));\r\n        }\r\n        if (!this.sendQueue) {\r\n            this.sendQueue = new TransportSendQueue(this.transport);\r\n        }\r\n        // Transport will not be null if state is connected\r\n        return this.sendQueue.send(data);\r\n    };\r\n    HttpConnection.prototype.stop = function (error) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (this.connectionState === \"Disconnected\" /* Disconnected */) {\r\n                            this.logger.log(LogLevel.Debug, \"Call to HttpConnection.stop(\" + error + \") ignored because the connection is already in the disconnected state.\");\r\n                            return [2 /*return*/, Promise.resolve()];\r\n                        }\r\n                        if (this.connectionState === \"Disconnecting\" /* Disconnecting */) {\r\n                            this.logger.log(LogLevel.Debug, \"Call to HttpConnection.stop(\" + error + \") ignored because the connection is already in the disconnecting state.\");\r\n                            return [2 /*return*/, this.stopPromise];\r\n                        }\r\n                        this.connectionState = \"Disconnecting\" /* Disconnecting */;\r\n                        this.stopPromise = new Promise(function (resolve) {\r\n                            // Don't complete stop() until stopConnection() completes.\r\n                            _this.stopPromiseResolver = resolve;\r\n                        });\r\n                        // stopInternal should never throw so just observe it.\r\n                        return [4 /*yield*/, this.stopInternal(error)];\r\n                    case 1:\r\n                        // stopInternal should never throw so just observe it.\r\n                        _a.sent();\r\n                        return [4 /*yield*/, this.stopPromise];\r\n                    case 2:\r\n                        _a.sent();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    HttpConnection.prototype.stopInternal = function (error) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var e_1, e_2;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        // Set error as soon as possible otherwise there is a race between\r\n                        // the transport closing and providing an error and the error from a close message\r\n                        // We would prefer the close message error.\r\n                        this.stopError = error;\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        _a.trys.push([1, 3, , 4]);\r\n                        return [4 /*yield*/, this.startInternalPromise];\r\n                    case 2:\r\n                        _a.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        e_1 = _a.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 4:\r\n                        if (!this.transport) return [3 /*break*/, 9];\r\n                        _a.label = 5;\r\n                    case 5:\r\n                        _a.trys.push([5, 7, , 8]);\r\n                        return [4 /*yield*/, this.transport.stop()];\r\n                    case 6:\r\n                        _a.sent();\r\n                        return [3 /*break*/, 8];\r\n                    case 7:\r\n                        e_2 = _a.sent();\r\n                        this.logger.log(LogLevel.Error, \"HttpConnection.transport.stop() threw error '\" + e_2 + \"'.\");\r\n                        this.stopConnection();\r\n                        return [3 /*break*/, 8];\r\n                    case 8:\r\n                        this.transport = undefined;\r\n                        return [3 /*break*/, 10];\r\n                    case 9:\r\n                        this.logger.log(LogLevel.Debug, \"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.\");\r\n                        this.stopConnection();\r\n                        _a.label = 10;\r\n                    case 10: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    HttpConnection.prototype.startInternal = function (transferFormat) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var url, negotiateResponse, redirects, _loop_1, this_1, e_3;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        url = this.baseUrl;\r\n                        this.accessTokenFactory = this.options.accessTokenFactory;\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        _a.trys.push([1, 12, , 13]);\r\n                        if (!this.options.skipNegotiation) return [3 /*break*/, 5];\r\n                        if (!(this.options.transport === HttpTransportType.WebSockets)) return [3 /*break*/, 3];\r\n                        // No need to add a connection ID in this case\r\n                        this.transport = this.constructTransport(HttpTransportType.WebSockets);\r\n                        // We should just call connect directly in this case.\r\n                        // No fallback or negotiate in this case.\r\n                        return [4 /*yield*/, this.startTransport(url, transferFormat)];\r\n                    case 2:\r\n                        // We should just call connect directly in this case.\r\n                        // No fallback or negotiate in this case.\r\n                        _a.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 3: throw new Error(\"Negotiation can only be skipped when using the WebSocket transport directly.\");\r\n                    case 4: return [3 /*break*/, 11];\r\n                    case 5:\r\n                        negotiateResponse = null;\r\n                        redirects = 0;\r\n                        _loop_1 = function () {\r\n                            var accessToken_1;\r\n                            return __generator(this, function (_a) {\r\n                                switch (_a.label) {\r\n                                    case 0: return [4 /*yield*/, this_1.getNegotiationResponse(url)];\r\n                                    case 1:\r\n                                        negotiateResponse = _a.sent();\r\n                                        // the user tries to stop the connection when it is being started\r\n                                        if (this_1.connectionState === \"Disconnecting\" /* Disconnecting */ || this_1.connectionState === \"Disconnected\" /* Disconnected */) {\r\n                                            throw new Error(\"The connection was stopped during negotiation.\");\r\n                                        }\r\n                                        if (negotiateResponse.error) {\r\n                                            throw new Error(negotiateResponse.error);\r\n                                        }\r\n                                        if (negotiateResponse.ProtocolVersion) {\r\n                                            throw new Error(\"Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.\");\r\n                                        }\r\n                                        if (negotiateResponse.url) {\r\n                                            url = negotiateResponse.url;\r\n                                        }\r\n                                        if (negotiateResponse.accessToken) {\r\n                                            accessToken_1 = negotiateResponse.accessToken;\r\n                                            this_1.accessTokenFactory = function () { return accessToken_1; };\r\n                                        }\r\n                                        redirects++;\r\n                                        return [2 /*return*/];\r\n                                }\r\n                            });\r\n                        };\r\n                        this_1 = this;\r\n                        _a.label = 6;\r\n                    case 6: return [5 /*yield**/, _loop_1()];\r\n                    case 7:\r\n                        _a.sent();\r\n                        _a.label = 8;\r\n                    case 8:\r\n                        if (negotiateResponse.url && redirects < MAX_REDIRECTS) return [3 /*break*/, 6];\r\n                        _a.label = 9;\r\n                    case 9:\r\n                        if (redirects === MAX_REDIRECTS && negotiateResponse.url) {\r\n                            throw new Error(\"Negotiate redirection limit exceeded.\");\r\n                        }\r\n                        return [4 /*yield*/, this.createTransport(url, this.options.transport, negotiateResponse, transferFormat)];\r\n                    case 10:\r\n                        _a.sent();\r\n                        _a.label = 11;\r\n                    case 11:\r\n                        if (this.transport instanceof LongPollingTransport) {\r\n                            this.features.inherentKeepAlive = true;\r\n                        }\r\n                        if (this.connectionState === \"Connecting \" /* Connecting */) {\r\n                            // Ensure the connection transitions to the connected state prior to completing this.startInternalPromise.\r\n                            // start() will handle the case when stop was called and startInternal exits still in the disconnecting state.\r\n                            this.logger.log(LogLevel.Debug, \"The HttpConnection connected successfully.\");\r\n                            this.connectionState = \"Connected\" /* Connected */;\r\n                        }\r\n                        return [3 /*break*/, 13];\r\n                    case 12:\r\n                        e_3 = _a.sent();\r\n                        this.logger.log(LogLevel.Error, \"Failed to start the connection: \" + e_3);\r\n                        this.connectionState = \"Disconnected\" /* Disconnected */;\r\n                        this.transport = undefined;\r\n                        return [2 /*return*/, Promise.reject(e_3)];\r\n                    case 13: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    HttpConnection.prototype.getNegotiationResponse = function (url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a, headers, token, negotiateUrl, response, negotiateResponse, e_4;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (!this.accessTokenFactory) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, this.accessTokenFactory()];\r\n                    case 1:\r\n                        token = _b.sent();\r\n                        if (token) {\r\n                            headers = (_a = {},\r\n                                _a[\"Authorization\"] = \"Bearer \" + token,\r\n                                _a);\r\n                        }\r\n                        _b.label = 2;\r\n                    case 2:\r\n                        negotiateUrl = this.resolveNegotiateUrl(url);\r\n                        this.logger.log(LogLevel.Debug, \"Sending negotiation request: \" + negotiateUrl + \".\");\r\n                        _b.label = 3;\r\n                    case 3:\r\n                        _b.trys.push([3, 5, , 6]);\r\n                        return [4 /*yield*/, this.httpClient.post(negotiateUrl, {\r\n                                content: \"\",\r\n                                headers: headers,\r\n                            })];\r\n                    case 4:\r\n                        response = _b.sent();\r\n                        if (response.statusCode !== 200) {\r\n                            return [2 /*return*/, Promise.reject(new Error(\"Unexpected status code returned from negotiate \" + response.statusCode))];\r\n                        }\r\n                        negotiateResponse = JSON.parse(response.content);\r\n                        if (!negotiateResponse.negotiateVersion || negotiateResponse.negotiateVersion < 1) {\r\n                            // Negotiate version 0 doesn't use connectionToken\r\n                            // So we set it equal to connectionId so all our logic can use connectionToken without being aware of the negotiate version\r\n                            negotiateResponse.connectionToken = negotiateResponse.connectionId;\r\n                        }\r\n                        return [2 /*return*/, negotiateResponse];\r\n                    case 5:\r\n                        e_4 = _b.sent();\r\n                        this.logger.log(LogLevel.Error, \"Failed to complete negotiation with the server: \" + e_4);\r\n                        return [2 /*return*/, Promise.reject(e_4)];\r\n                    case 6: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    HttpConnection.prototype.createConnectUrl = function (url, connectionToken) {\r\n        if (!connectionToken) {\r\n            return url;\r\n        }\r\n        return url + (url.indexOf(\"?\") === -1 ? \"?\" : \"&\") + (\"id=\" + connectionToken);\r\n    };\r\n    HttpConnection.prototype.createTransport = function (url, requestedTransport, negotiateResponse, requestedTransferFormat) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var connectUrl, transportExceptions, transports, negotiate, _i, transports_1, endpoint, transportOrError, ex_1, ex_2, message;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        connectUrl = this.createConnectUrl(url, negotiateResponse.connectionToken);\r\n                        if (!this.isITransport(requestedTransport)) return [3 /*break*/, 2];\r\n                        this.logger.log(LogLevel.Debug, \"Connection was provided an instance of ITransport, using that directly.\");\r\n                        this.transport = requestedTransport;\r\n                        return [4 /*yield*/, this.startTransport(connectUrl, requestedTransferFormat)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        this.connectionId = negotiateResponse.connectionId;\r\n                        return [2 /*return*/];\r\n                    case 2:\r\n                        transportExceptions = [];\r\n                        transports = negotiateResponse.availableTransports || [];\r\n                        negotiate = negotiateResponse;\r\n                        _i = 0, transports_1 = transports;\r\n                        _a.label = 3;\r\n                    case 3:\r\n                        if (!(_i < transports_1.length)) return [3 /*break*/, 13];\r\n                        endpoint = transports_1[_i];\r\n                        transportOrError = this.resolveTransportOrError(endpoint, requestedTransport, requestedTransferFormat);\r\n                        if (!(transportOrError instanceof Error)) return [3 /*break*/, 4];\r\n                        // Store the error and continue, we don't want to cause a re-negotiate in these cases\r\n                        transportExceptions.push(endpoint.transport + \" failed: \" + transportOrError);\r\n                        return [3 /*break*/, 12];\r\n                    case 4:\r\n                        if (!this.isITransport(transportOrError)) return [3 /*break*/, 12];\r\n                        this.transport = transportOrError;\r\n                        if (!!negotiate) return [3 /*break*/, 9];\r\n                        _a.label = 5;\r\n                    case 5:\r\n                        _a.trys.push([5, 7, , 8]);\r\n                        return [4 /*yield*/, this.getNegotiationResponse(url)];\r\n                    case 6:\r\n                        negotiate = _a.sent();\r\n                        return [3 /*break*/, 8];\r\n                    case 7:\r\n                        ex_1 = _a.sent();\r\n                        return [2 /*return*/, Promise.reject(ex_1)];\r\n                    case 8:\r\n                        connectUrl = this.createConnectUrl(url, negotiate.connectionToken);\r\n                        _a.label = 9;\r\n                    case 9:\r\n                        _a.trys.push([9, 11, , 12]);\r\n                        return [4 /*yield*/, this.startTransport(connectUrl, requestedTransferFormat)];\r\n                    case 10:\r\n                        _a.sent();\r\n                        this.connectionId = negotiate.connectionId;\r\n                        return [2 /*return*/];\r\n                    case 11:\r\n                        ex_2 = _a.sent();\r\n                        this.logger.log(LogLevel.Error, \"Failed to start the transport '\" + endpoint.transport + \"': \" + ex_2);\r\n                        negotiate = undefined;\r\n                        transportExceptions.push(endpoint.transport + \" failed: \" + ex_2);\r\n                        if (this.connectionState !== \"Connecting \" /* Connecting */) {\r\n                            message = \"Failed to select transport before stop() was called.\";\r\n                            this.logger.log(LogLevel.Debug, message);\r\n                            return [2 /*return*/, Promise.reject(new Error(message))];\r\n                        }\r\n                        return [3 /*break*/, 12];\r\n                    case 12:\r\n                        _i++;\r\n                        return [3 /*break*/, 3];\r\n                    case 13:\r\n                        if (transportExceptions.length > 0) {\r\n                            return [2 /*return*/, Promise.reject(new Error(\"Unable to connect to the server with any of the available transports. \" + transportExceptions.join(\" \")))];\r\n                        }\r\n                        return [2 /*return*/, Promise.reject(new Error(\"None of the transports supported by the client are supported by the server.\"))];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    HttpConnection.prototype.constructTransport = function (transport) {\r\n        switch (transport) {\r\n            case HttpTransportType.WebSockets:\r\n                if (!this.options.WebSocket) {\r\n                    throw new Error(\"'WebSocket' is not supported in your environment.\");\r\n                }\r\n                return new WebSocketTransport(this.httpClient, this.accessTokenFactory, this.logger, this.options.logMessageContent || false, this.options.WebSocket);\r\n            case HttpTransportType.ServerSentEvents:\r\n                if (!this.options.EventSource) {\r\n                    throw new Error(\"'EventSource' is not supported in your environment.\");\r\n                }\r\n                return new ServerSentEventsTransport(this.httpClient, this.accessTokenFactory, this.logger, this.options.logMessageContent || false, this.options.EventSource);\r\n            case HttpTransportType.LongPolling:\r\n                return new LongPollingTransport(this.httpClient, this.accessTokenFactory, this.logger, this.options.logMessageContent || false);\r\n            default:\r\n                throw new Error(\"Unknown transport: \" + transport + \".\");\r\n        }\r\n    };\r\n    HttpConnection.prototype.startTransport = function (url, transferFormat) {\r\n        var _this = this;\r\n        this.transport.onreceive = this.onreceive;\r\n        this.transport.onclose = function (e) { return _this.stopConnection(e); };\r\n        return this.transport.connect(url, transferFormat);\r\n    };\r\n    HttpConnection.prototype.resolveTransportOrError = function (endpoint, requestedTransport, requestedTransferFormat) {\r\n        var transport = HttpTransportType[endpoint.transport];\r\n        if (transport === null || transport === undefined) {\r\n            this.logger.log(LogLevel.Debug, \"Skipping transport '\" + endpoint.transport + \"' because it is not supported by this client.\");\r\n            return new Error(\"Skipping transport '\" + endpoint.transport + \"' because it is not supported by this client.\");\r\n        }\r\n        else {\r\n            if (transportMatches(requestedTransport, transport)) {\r\n                var transferFormats = endpoint.transferFormats.map(function (s) { return TransferFormat[s]; });\r\n                if (transferFormats.indexOf(requestedTransferFormat) >= 0) {\r\n                    if ((transport === HttpTransportType.WebSockets && !this.options.WebSocket) ||\r\n                        (transport === HttpTransportType.ServerSentEvents && !this.options.EventSource)) {\r\n                        this.logger.log(LogLevel.Debug, \"Skipping transport '\" + HttpTransportType[transport] + \"' because it is not supported in your environment.'\");\r\n                        return new Error(\"'\" + HttpTransportType[transport] + \"' is not supported in your environment.\");\r\n                    }\r\n                    else {\r\n                        this.logger.log(LogLevel.Debug, \"Selecting transport '\" + HttpTransportType[transport] + \"'.\");\r\n                        try {\r\n                            return this.constructTransport(transport);\r\n                        }\r\n                        catch (ex) {\r\n                            return ex;\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    this.logger.log(LogLevel.Debug, \"Skipping transport '\" + HttpTransportType[transport] + \"' because it does not support the requested transfer format '\" + TransferFormat[requestedTransferFormat] + \"'.\");\r\n                    return new Error(\"'\" + HttpTransportType[transport] + \"' does not support \" + TransferFormat[requestedTransferFormat] + \".\");\r\n                }\r\n            }\r\n            else {\r\n                this.logger.log(LogLevel.Debug, \"Skipping transport '\" + HttpTransportType[transport] + \"' because it was disabled by the client.\");\r\n                return new Error(\"'\" + HttpTransportType[transport] + \"' is disabled by the client.\");\r\n            }\r\n        }\r\n    };\r\n    HttpConnection.prototype.isITransport = function (transport) {\r\n        return transport && typeof (transport) === \"object\" && \"connect\" in transport;\r\n    };\r\n    HttpConnection.prototype.stopConnection = function (error) {\r\n        var _this = this;\r\n        this.logger.log(LogLevel.Debug, \"HttpConnection.stopConnection(\" + error + \") called while in state \" + this.connectionState + \".\");\r\n        this.transport = undefined;\r\n        // If we have a stopError, it takes precedence over the error from the transport\r\n        error = this.stopError || error;\r\n        this.stopError = undefined;\r\n        if (this.connectionState === \"Disconnected\" /* Disconnected */) {\r\n            this.logger.log(LogLevel.Debug, \"Call to HttpConnection.stopConnection(\" + error + \") was ignored because the connection is already in the disconnected state.\");\r\n            return;\r\n        }\r\n        if (this.connectionState === \"Connecting \" /* Connecting */) {\r\n            this.logger.log(LogLevel.Warning, \"Call to HttpConnection.stopConnection(\" + error + \") was ignored because the connection hasn't yet left the in the connecting state.\");\r\n            return;\r\n        }\r\n        if (this.connectionState === \"Disconnecting\" /* Disconnecting */) {\r\n            // A call to stop() induced this call to stopConnection and needs to be completed.\r\n            // Any stop() awaiters will be scheduled to continue after the onclose callback fires.\r\n            this.stopPromiseResolver();\r\n        }\r\n        if (error) {\r\n            this.logger.log(LogLevel.Error, \"Connection disconnected with error '\" + error + \"'.\");\r\n        }\r\n        else {\r\n            this.logger.log(LogLevel.Information, \"Connection disconnected.\");\r\n        }\r\n        if (this.sendQueue) {\r\n            this.sendQueue.stop().catch(function (e) {\r\n                _this.logger.log(LogLevel.Error, \"TransportSendQueue.stop() threw error '\" + e + \"'.\");\r\n            });\r\n            this.sendQueue = undefined;\r\n        }\r\n        this.connectionId = undefined;\r\n        this.connectionState = \"Disconnected\" /* Disconnected */;\r\n        if (this.connectionStarted) {\r\n            this.connectionStarted = false;\r\n            try {\r\n                if (this.onclose) {\r\n                    this.onclose(error);\r\n                }\r\n            }\r\n            catch (e) {\r\n                this.logger.log(LogLevel.Error, \"HttpConnection.onclose(\" + error + \") threw error '\" + e + \"'.\");\r\n            }\r\n        }\r\n    };\r\n    HttpConnection.prototype.resolveUrl = function (url) {\r\n        // startsWith is not supported in IE\r\n        if (url.lastIndexOf(\"https://\", 0) === 0 || url.lastIndexOf(\"http://\", 0) === 0) {\r\n            return url;\r\n        }\r\n        if (!Platform.isBrowser || !window.document) {\r\n            throw new Error(\"Cannot resolve '\" + url + \"'.\");\r\n        }\r\n        // Setting the url to the href propery of an anchor tag handles normalization\r\n        // for us. There are 3 main cases.\r\n        // 1. Relative path normalization e.g \"b\" -> \"http://localhost:5000/a/b\"\r\n        // 2. Absolute path normalization e.g \"/a/b\" -> \"http://localhost:5000/a/b\"\r\n        // 3. Networkpath reference normalization e.g \"//localhost:5000/a/b\" -> \"http://localhost:5000/a/b\"\r\n        var aTag = window.document.createElement(\"a\");\r\n        aTag.href = url;\r\n        this.logger.log(LogLevel.Information, \"Normalizing '\" + url + \"' to '\" + aTag.href + \"'.\");\r\n        return aTag.href;\r\n    };\r\n    HttpConnection.prototype.resolveNegotiateUrl = function (url) {\r\n        var index = url.indexOf(\"?\");\r\n        var negotiateUrl = url.substring(0, index === -1 ? url.length : index);\r\n        if (negotiateUrl[negotiateUrl.length - 1] !== \"/\") {\r\n            negotiateUrl += \"/\";\r\n        }\r\n        negotiateUrl += \"negotiate\";\r\n        negotiateUrl += index === -1 ? \"\" : url.substring(index);\r\n        if (negotiateUrl.indexOf(\"negotiateVersion\") === -1) {\r\n            negotiateUrl += index === -1 ? \"?\" : \"&\";\r\n            negotiateUrl += \"negotiateVersion=\" + this.negotiateVersion;\r\n        }\r\n        return negotiateUrl;\r\n    };\r\n    return HttpConnection;\r\n}());\r\nexport { HttpConnection };\r\nfunction transportMatches(requestedTransport, actualTransport) {\r\n    return !requestedTransport || ((actualTransport & requestedTransport) !== 0);\r\n}\r\n/** @private */\r\nvar TransportSendQueue = /** @class */ (function () {\r\n    function TransportSendQueue(transport) {\r\n        this.transport = transport;\r\n        this.buffer = [];\r\n        this.executing = true;\r\n        this.sendBufferedData = new PromiseSource();\r\n        this.transportResult = new PromiseSource();\r\n        this.sendLoopPromise = this.sendLoop();\r\n    }\r\n    TransportSendQueue.prototype.send = function (data) {\r\n        this.bufferData(data);\r\n        if (!this.transportResult) {\r\n            this.transportResult = new PromiseSource();\r\n        }\r\n        return this.transportResult.promise;\r\n    };\r\n    TransportSendQueue.prototype.stop = function () {\r\n        this.executing = false;\r\n        this.sendBufferedData.resolve();\r\n        return this.sendLoopPromise;\r\n    };\r\n    TransportSendQueue.prototype.bufferData = function (data) {\r\n        if (this.buffer.length && typeof (this.buffer[0]) !== typeof (data)) {\r\n            throw new Error(\"Expected data to be of type \" + typeof (this.buffer) + \" but was of type \" + typeof (data));\r\n        }\r\n        this.buffer.push(data);\r\n        this.sendBufferedData.resolve();\r\n    };\r\n    TransportSendQueue.prototype.sendLoop = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var transportResult, data, error_1;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!true) return [3 /*break*/, 6];\r\n                        return [4 /*yield*/, this.sendBufferedData.promise];\r\n                    case 1:\r\n                        _a.sent();\r\n                        if (!this.executing) {\r\n                            if (this.transportResult) {\r\n                                this.transportResult.reject(\"Connection stopped.\");\r\n                            }\r\n                            return [3 /*break*/, 6];\r\n                        }\r\n                        this.sendBufferedData = new PromiseSource();\r\n                        transportResult = this.transportResult;\r\n                        this.transportResult = undefined;\r\n                        data = typeof (this.buffer[0]) === \"string\" ?\r\n                            this.buffer.join(\"\") :\r\n                            TransportSendQueue.concatBuffers(this.buffer);\r\n                        this.buffer.length = 0;\r\n                        _a.label = 2;\r\n                    case 2:\r\n                        _a.trys.push([2, 4, , 5]);\r\n                        return [4 /*yield*/, this.transport.send(data)];\r\n                    case 3:\r\n                        _a.sent();\r\n                        transportResult.resolve();\r\n                        return [3 /*break*/, 5];\r\n                    case 4:\r\n                        error_1 = _a.sent();\r\n                        transportResult.reject(error_1);\r\n                        return [3 /*break*/, 5];\r\n                    case 5: return [3 /*break*/, 0];\r\n                    case 6: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    TransportSendQueue.concatBuffers = function (arrayBuffers) {\r\n        var totalLength = arrayBuffers.map(function (b) { return b.byteLength; }).reduce(function (a, b) { return a + b; });\r\n        var result = new Uint8Array(totalLength);\r\n        var offset = 0;\r\n        for (var _i = 0, arrayBuffers_1 = arrayBuffers; _i < arrayBuffers_1.length; _i++) {\r\n            var item = arrayBuffers_1[_i];\r\n            result.set(new Uint8Array(item), offset);\r\n            offset += item.byteLength;\r\n        }\r\n        return result;\r\n    };\r\n    return TransportSendQueue;\r\n}());\r\nexport { TransportSendQueue };\r\nvar PromiseSource = /** @class */ (function () {\r\n    function PromiseSource() {\r\n        var _this = this;\r\n        this.promise = new Promise(function (resolve, reject) {\r\n            var _a;\r\n            return _a = [resolve, reject], _this.resolver = _a[0], _this.rejecter = _a[1], _a;\r\n        });\r\n    }\r\n    PromiseSource.prototype.resolve = function () {\r\n        this.resolver();\r\n    };\r\n    PromiseSource.prototype.reject = function (reason) {\r\n        this.rejecter(reason);\r\n    };\r\n    return PromiseSource;\r\n}());\r\n//# sourceMappingURL=HttpConnection.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\nimport { MessageType } from \"./IHubProtocol\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { TransferFormat } from \"./ITransport\";\r\nimport { NullLogger } from \"./Loggers\";\r\nimport { TextMessageFormat } from \"./TextMessageFormat\";\r\nvar JSON_HUB_PROTOCOL_NAME = \"json\";\r\n/** Implements the JSON Hub Protocol. */\r\nvar JsonHubProtocol = /** @class */ (function () {\r\n    function JsonHubProtocol() {\r\n        /** @inheritDoc */\r\n        this.name = JSON_HUB_PROTOCOL_NAME;\r\n        /** @inheritDoc */\r\n        this.version = 1;\r\n        /** @inheritDoc */\r\n        this.transferFormat = TransferFormat.Text;\r\n    }\r\n    /** Creates an array of {@link @microsoft/signalr.HubMessage} objects from the specified serialized representation.\r\n     *\r\n     * @param {string} input A string containing the serialized representation.\r\n     * @param {ILogger} logger A logger that will be used to log messages that occur during parsing.\r\n     */\r\n    JsonHubProtocol.prototype.parseMessages = function (input, logger) {\r\n        // The interface does allow \"ArrayBuffer\" to be passed in, but this implementation does not. So let's throw a useful error.\r\n        if (typeof input !== \"string\") {\r\n            throw new Error(\"Invalid input for JSON hub protocol. Expected a string.\");\r\n        }\r\n        if (!input) {\r\n            return [];\r\n        }\r\n        if (logger === null) {\r\n            logger = NullLogger.instance;\r\n        }\r\n        // Parse the messages\r\n        var messages = TextMessageFormat.parse(input);\r\n        var hubMessages = [];\r\n        for (var _i = 0, messages_1 = messages; _i < messages_1.length; _i++) {\r\n            var message = messages_1[_i];\r\n            var parsedMessage = JSON.parse(message);\r\n            if (typeof parsedMessage.type !== \"number\") {\r\n                throw new Error(\"Invalid payload.\");\r\n            }\r\n            switch (parsedMessage.type) {\r\n                case MessageType.Invocation:\r\n                    this.isInvocationMessage(parsedMessage);\r\n                    break;\r\n                case MessageType.StreamItem:\r\n                    this.isStreamItemMessage(parsedMessage);\r\n                    break;\r\n                case MessageType.Completion:\r\n                    this.isCompletionMessage(parsedMessage);\r\n                    break;\r\n                case MessageType.Ping:\r\n                    // Single value, no need to validate\r\n                    break;\r\n                case MessageType.Close:\r\n                    // All optional values, no need to validate\r\n                    break;\r\n                default:\r\n                    // Future protocol changes can add message types, old clients can ignore them\r\n                    logger.log(LogLevel.Information, \"Unknown message type '\" + parsedMessage.type + \"' ignored.\");\r\n                    continue;\r\n            }\r\n            hubMessages.push(parsedMessage);\r\n        }\r\n        return hubMessages;\r\n    };\r\n    /** Writes the specified {@link @microsoft/signalr.HubMessage} to a string and returns it.\r\n     *\r\n     * @param {HubMessage} message The message to write.\r\n     * @returns {string} A string containing the serialized representation of the message.\r\n     */\r\n    JsonHubProtocol.prototype.writeMessage = function (message) {\r\n        return TextMessageFormat.write(JSON.stringify(message));\r\n    };\r\n    JsonHubProtocol.prototype.isInvocationMessage = function (message) {\r\n        this.assertNotEmptyString(message.target, \"Invalid payload for Invocation message.\");\r\n        if (message.invocationId !== undefined) {\r\n            this.assertNotEmptyString(message.invocationId, \"Invalid payload for Invocation message.\");\r\n        }\r\n    };\r\n    JsonHubProtocol.prototype.isStreamItemMessage = function (message) {\r\n        this.assertNotEmptyString(message.invocationId, \"Invalid payload for StreamItem message.\");\r\n        if (message.item === undefined) {\r\n            throw new Error(\"Invalid payload for StreamItem message.\");\r\n        }\r\n    };\r\n    JsonHubProtocol.prototype.isCompletionMessage = function (message) {\r\n        if (message.result && message.error) {\r\n            throw new Error(\"Invalid payload for Completion message.\");\r\n        }\r\n        if (!message.result && message.error) {\r\n            this.assertNotEmptyString(message.error, \"Invalid payload for Completion message.\");\r\n        }\r\n        this.assertNotEmptyString(message.invocationId, \"Invalid payload for Completion message.\");\r\n    };\r\n    JsonHubProtocol.prototype.assertNotEmptyString = function (value, errorMessage) {\r\n        if (typeof value !== \"string\" || value === \"\") {\r\n            throw new Error(errorMessage);\r\n        }\r\n    };\r\n    return JsonHubProtocol;\r\n}());\r\nexport { JsonHubProtocol };\r\n//# sourceMappingURL=JsonHubProtocol.js.map","// Copyright (c) .NET Foundation. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.\r\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n            t[p] = s[p];\r\n    }\r\n    return t;\r\n};\r\nimport { DefaultReconnectPolicy } from \"./DefaultReconnectPolicy\";\r\nimport { HttpConnection } from \"./HttpConnection\";\r\nimport { HubConnection } from \"./HubConnection\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { JsonHubProtocol } from \"./JsonHubProtocol\";\r\nimport { NullLogger } from \"./Loggers\";\r\nimport { Arg, ConsoleLogger } from \"./Utils\";\r\n// tslint:disable:object-literal-sort-keys\r\nvar LogLevelNameMapping = {\r\n    trace: LogLevel.Trace,\r\n    debug: LogLevel.Debug,\r\n    info: LogLevel.Information,\r\n    information: LogLevel.Information,\r\n    warn: LogLevel.Warning,\r\n    warning: LogLevel.Warning,\r\n    error: LogLevel.Error,\r\n    critical: LogLevel.Critical,\r\n    none: LogLevel.None,\r\n};\r\nfunction parseLogLevel(name) {\r\n    // Case-insensitive matching via lower-casing\r\n    // Yes, I know case-folding is a complicated problem in Unicode, but we only support\r\n    // the ASCII strings defined in LogLevelNameMapping anyway, so it's fine -anurse.\r\n    var mapping = LogLevelNameMapping[name.toLowerCase()];\r\n    if (typeof mapping !== \"undefined\") {\r\n        return mapping;\r\n    }\r\n    else {\r\n        throw new Error(\"Unknown log level: \" + name);\r\n    }\r\n}\r\n/** A builder for configuring {@link @microsoft/signalr.HubConnection} instances. */\r\nvar HubConnectionBuilder = /** @class */ (function () {\r\n    function HubConnectionBuilder() {\r\n    }\r\n    HubConnectionBuilder.prototype.configureLogging = function (logging) {\r\n        Arg.isRequired(logging, \"logging\");\r\n        if (isLogger(logging)) {\r\n            this.logger = logging;\r\n        }\r\n        else if (typeof logging === \"string\") {\r\n            var logLevel = parseLogLevel(logging);\r\n            this.logger = new ConsoleLogger(logLevel);\r\n        }\r\n        else {\r\n            this.logger = new ConsoleLogger(logging);\r\n        }\r\n        return this;\r\n    };\r\n    HubConnectionBuilder.prototype.withUrl = function (url, transportTypeOrOptions) {\r\n        Arg.isRequired(url, \"url\");\r\n        this.url = url;\r\n        // Flow-typing knows where it's at. Since HttpTransportType is a number and IHttpConnectionOptions is guaranteed\r\n        // to be an object, we know (as does TypeScript) this comparison is all we need to figure out which overload was called.\r\n        if (typeof transportTypeOrOptions === \"object\") {\r\n            this.httpConnectionOptions = __assign({}, this.httpConnectionOptions, transportTypeOrOptions);\r\n        }\r\n        else {\r\n            this.httpConnectionOptions = __assign({}, this.httpConnectionOptions, { transport: transportTypeOrOptions });\r\n        }\r\n        return this;\r\n    };\r\n    /** Configures the {@link @microsoft/signalr.HubConnection} to use the specified Hub Protocol.\r\n     *\r\n     * @param {IHubProtocol} protocol The {@link @microsoft/signalr.IHubProtocol} implementation to use.\r\n     */\r\n    HubConnectionBuilder.prototype.withHubProtocol = function (protocol) {\r\n        Arg.isRequired(protocol, \"protocol\");\r\n        this.protocol = protocol;\r\n        return this;\r\n    };\r\n    HubConnectionBuilder.prototype.withAutomaticReconnect = function (retryDelaysOrReconnectPolicy) {\r\n        if (this.reconnectPolicy) {\r\n            throw new Error(\"A reconnectPolicy has already been set.\");\r\n        }\r\n        if (!retryDelaysOrReconnectPolicy) {\r\n            this.reconnectPolicy = new DefaultReconnectPolicy();\r\n        }\r\n        else if (Array.isArray(retryDelaysOrReconnectPolicy)) {\r\n            this.reconnectPolicy = new DefaultReconnectPolicy(retryDelaysOrReconnectPolicy);\r\n        }\r\n        else {\r\n            this.reconnectPolicy = retryDelaysOrReconnectPolicy;\r\n        }\r\n        return this;\r\n    };\r\n    /** Creates a {@link @microsoft/signalr.HubConnection} from the configuration options specified in this builder.\r\n     *\r\n     * @returns {HubConnection} The configured {@link @microsoft/signalr.HubConnection}.\r\n     */\r\n    HubConnectionBuilder.prototype.build = function () {\r\n        // If httpConnectionOptions has a logger, use it. Otherwise, override it with the one\r\n        // provided to configureLogger\r\n        var httpConnectionOptions = this.httpConnectionOptions || {};\r\n        // If it's 'null', the user **explicitly** asked for null, don't mess with it.\r\n        if (httpConnectionOptions.logger === undefined) {\r\n            // If our logger is undefined or null, that's OK, the HttpConnection constructor will handle it.\r\n            httpConnectionOptions.logger = this.logger;\r\n        }\r\n        // Now create the connection\r\n        if (!this.url) {\r\n            throw new Error(\"The 'HubConnectionBuilder.withUrl' method must be called before building the connection.\");\r\n        }\r\n        var connection = new HttpConnection(this.url, httpConnectionOptions);\r\n        return HubConnection.create(connection, this.logger || NullLogger.instance, this.protocol || new JsonHubProtocol(), this.reconnectPolicy);\r\n    };\r\n    return HubConnectionBuilder;\r\n}());\r\nexport { HubConnectionBuilder };\r\nfunction isLogger(logger) {\r\n    return logger.log !== undefined;\r\n}\r\n//# sourceMappingURL=HubConnectionBuilder.js.map","\"use strict\";\r\nimport * as signalr from '@microsoft/signalr';\r\nconst connection = new signalr\r\n    .HubConnectionBuilder()\r\n    .withUrl(\"/updates\")\r\n    .configureLogging(signalr.LogLevel.Information)\r\n    .withAutomaticReconnect()\r\n    .build();\r\nexport const begin = async () => {\r\n    try {\r\n        await connection.start();\r\n    }\r\n    catch (err) {\r\n        console.error(err);\r\n    }\r\n};\r\nexport const ping = planeId => {\r\n    connection.invoke(\"Ping\", planeId)\r\n        .catch(console.error);\r\n};\r\nconnection.on(\"pong\", planeId => console.log(\"pong: \" + planeId));\r\nconnection.on(\"ReceiveMessage\", (user, message) => console.log(`user: ${user} message: ${message}`));\r\nconnection.on(\"UpdatePlane\", console.log);\r\n","<script>\r\n    export let plane;\r\n    export let planeid;\r\n    export let className = `orbit-icon fa plane-${planeid}`;\r\n    export let center = false;\r\n\r\n    import { createEventDispatcher } from 'svelte';\r\n\r\n    const dispatch = createEventDispatcher();\r\n\r\n    const handleHover = () => {\r\n        dispatch('message', {\r\n            plane\r\n        });\r\n    };\r\n\r\n    let display = plane.locked\r\n        ? \"L\"\r\n        : plane.name.substring(0, 1).toUpperCase();\r\n</script>\r\n\r\n<li \r\n    class={className} \r\n    on:mouseover={handleHover} \r\n    on:mouseout={() => dispatch('message', { })}\r\n    on:click={() => dispatch('click', { plane })}\r\n>\r\n    {#if center}\r\n        <i class=\"fa fa-home\"></i>\r\n    {:else if plane.locked}\r\n        <i class=\"fa fa-lock\"></i>\r\n    {:else}\r\n        {display}\r\n    {/if}\r\n</li>","<script>\r\n    import Plane from './Plane.svelte';\r\n\r\n    export let rings;\r\n\r\n    const [center, ...rest] = rings;\r\n</script>\r\n\r\n<ul class=\"orbit-wrap\">\r\n\r\n  <Plane plane={center} className=\"orbit-center\" center={true} />\r\n\r\n  {#each rest as ring, i}\r\n    <li>\r\n      <ul class=\"ring-{i}\">\r\n        {#each ring.planes as plane, planeid (plane.id)}\r\n          <Plane plane={plane} on:message on:click {planeid} />\r\n        {/each}\r\n      </ul>\r\n    </li>\r\n  {/each}\r\n\r\n</ul>\r\n","<script lang=\"ts\">\r\n  import { fade } from 'svelte/transition';\r\n\r\n  import { rings } from './data';\r\n  import { begin, ping } from './signalr';\r\n\r\n  import Orbit from './Orbit.svelte';\r\n\r\n  $: descriptionText = '';\r\n  $: view = 'orbit';\r\n  $: currentPlane = {};\r\n\r\n  const handleHover = (event) => {\r\n    if (!event.detail.plane) {\r\n      descriptionText = '';\r\n    } else if (event.detail.plane && event.detail.plane.locked) {\r\n      descriptionText = 'Locked';\r\n    } else {\r\n      descriptionText = event.detail.plane.description;\r\n    }\r\n  };\r\n\r\n  const changeView = (event) => {\r\n    currentPlane = event.detail.plane;\r\n    view = 'description';\r\n  };\r\n\r\n  const resetView = () => {\r\n    view = 'orbit';\r\n    currentPlane = {};\r\n    descriptionText = '';\r\n  };\r\n\r\n  let connection = begin();\r\n</script>\r\n\r\n<style type=\"text/scss\">\r\n  #connected-box {\r\n    background-color:rgba(255, 255, 255, 0.7);\r\n    padding: 4px;\r\n    position: absolute;\r\n    right: 24px;\r\n    top: 24px;\r\n\r\n    &.success {\r\n      color: green;\r\n    }\r\n  }\r\n\r\n  #description-container {\r\n    background-color: #ececec;\r\n    border-radius: 4px;\r\n    bottom: 50px;\r\n    box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);\r\n    font-family: apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;\r\n    height: 200px;\r\n    padding: 12px;\r\n    position: absolute;\r\n    right: 50px;\r\n    width: 400px;\r\n  }\r\n\r\n  .large-description-container {\r\n    align-items: center;\r\n    display: flex;\r\n    height: 100vh;\r\n    justify-content: center;\r\n    width: 100vw;\r\n  }\r\n\r\n  .large-description {\r\n    background-color: #ececec;\r\n    border-radius: 4px;\r\n    box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);\r\n    font-family: apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;\r\n    height: 60vh;\r\n    padding: 24px;\r\n    position: absolute;\r\n    width: 40vw;\r\n  }\r\n</style>\r\n\r\n<main class=\"orbit\">\r\n  <!-- {#await connection}\r\n    <div id=\"connected-box\">\r\n      <i class=\"fa fa-spinner\"></i>\r\n    </div>\r\n  {:then _}\r\n    <div id=\"connected-box\" class=\"success\">\r\n      <i class=\"fa fa-link\"></i>\r\n      <button type=\"button\" on:click={() => ping(2)}>\r\n        ping\r\n      </button>\r\n    </div>\r\n  {/await} -->\r\n  {#if view === 'orbit'}\r\n    <span transition:fade>\r\n      <Orbit {rings} on:message={handleHover} on:click={changeView} />\r\n\r\n      {#if descriptionText}\r\n        <div id=\"description-container\" transition:fade>{descriptionText}</div>\r\n      {/if}\r\n    </span>\r\n  {:else}\r\n    <div class=\"large-description-container\">\r\n      <div class=\"large-description\" transition:fade>\r\n        {#if currentPlane.locked}\r\n          <i class=\"fa fa-lock\"></i>\r\n        {:else}\r\n          <h2>{currentPlane.name}</h2>\r\n          <p>{currentPlane.description}</p>\r\n        {/if}\r\n        <p>\r\n          <button on:click={resetView}>Close</button>\r\n        </p>\r\n      </div>\r\n    </div>\r\n  {/if}\r\n</main>\r\n","import App from './App.svelte';\r\nconst app = new App({\r\n    target: document.body,\r\n});\r\nexport default app;\r\n"],"names":["noop","identity","x","run","fn","blank_object","Object","create","run_all","fns","forEach","is_function","thing","safe_not_equal","a","b","is_client","window","now","performance","Date","raf","cb","requestAnimationFrame","tasks","Set","run_tasks","task","c","delete","f","size","append","target","node","appendChild","insert","anchor","insertBefore","detach","parentNode","removeChild","element","name","document","createElement","text","data","createTextNode","space","listen","event","handler","options","addEventListener","removeEventListener","attr","attribute","value","removeAttribute","getAttribute","setAttribute","set_data","wholeText","custom_event","type","detail","e","createEvent","initCustomEvent","active_docs","current_component","active","create_rule","duration","delay","ease","uid","step","keyframes","p","t","rule","str","hash","i","length","charCodeAt","doc","ownerDocument","add","stylesheet","__svelte_stylesheet","head","sheet","current_rules","__svelte_rules","insertRule","cssRules","animation","style","delete_rule","previous","split","next","filter","anim","indexOf","deleted","join","deleteRule","clear","set_current_component","component","createEventDispatcher","Error","get_current_component","callbacks","$$","slice","call","bubble","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","Promise","resolve","update_scheduled","add_render_callback","push","flushing","seen_callbacks","flush","update","pop","callback","has","fragment","before_update","dirty","ctx","after_update","promise","dispatch","direction","kind","dispatchEvent","outroing","outros","group_outros","r","check_outros","transition_in","block","local","transition_out","o","d","null_transition","create_bidirectional_transition","params","intro","config","running_program","pending_program","animation_name","clear_animation","init","program","Math","abs","start","end","group","go","easing","tick","css","fulfill","loop","[object Object]","then","outro_and_destroy_block","lookup","key","create_component","mount_component","on_mount","on_destroy","m","new_on_destroy","map","destroy_component","detaching","make_dirty","fill","instance","create_fragment","not_equal","props","parent_component","prop_values","bound","context","Map","ready","ret","rest","hydrate","nodes","Array","from","childNodes","children","l","SvelteComponent","this","$destroy","index","splice","fade","linear","getComputedStyle","opacity","rings","locked","planes","id","description","extendStatics","LogLevel","__extends","setPrototypeOf","__proto__","hasOwnProperty","__","constructor","prototype","HttpError","_super","errorMessage","statusCode","_this","trueProto","TimeoutError","AbortError","__assign","assign","s","n","arguments","HttpResponse","statusText","content","HttpClient","get","url","send","method","post","getCookieString","NullLogger","log","_logLevel","_message","__awaiter","thisArg","_arguments","P","generator","reject","fulfilled","rejected","result","done","apply","__generator","body","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","v","op","TypeError","Arg","isRequired","val","isIn","values","Platform","defineProperty","enumerable","configurable","self","isBrowser","isWebWorker","getDataDetail","includeContent","isArrayBuffer","byteLength","view","Uint8Array","num","toString","substr","formatArrayBuffer","ArrayBuffer","sendMessage","logger","transportName","httpClient","accessTokenFactory","logMessageContent","_a","headers","token","responseType","response","_b","Trace","requestModule","SubjectSubscription","subject","observer","dispose","observers","cancelCallback","catch","ConsoleLogger","minimumLogLevel","outputConsole","console","logLevel","message","Critical","error","toISOString","Warning","warn","Information","info","XMLHttpRequest","requireFunc","__webpack_require__","__non_webpack_require__","require","MessageType","NodeHttpClient","cookieJar","jar","request","defaults","httpRequest","abortSignal","aborted","requestBody","Buffer","currentRequest","encoding","X-Requested-With","timeout","onabort","code","statusMessage","abort","XhrHttpClient","xhr","open","withCredentials","setRequestHeader","keys","header","onload","status","responseText","onerror","ontimeout","DefaultHttpClient","TextMessageFormat","write","output","RecordSeparator","parse","input","messages","RecordSeparatorCode","String","fromCharCode","HandshakeProtocol","writeHandshakeRequest","handshakeRequest","JSON","stringify","parseHandshakeResponse","messageData","remainingData","binaryData","separatorIndex","responseLength","buffer","textData","substring","HubConnectionState","Subject","item","_i","err","complete","subscribe","HttpTransportType","TransferFormat","HubConnection","connection","protocol","reconnectPolicy","serverTimeoutInMilliseconds","keepAliveIntervalInMilliseconds","handshakeProtocol","onreceive","processIncomingData","onclose","connectionClosed","methods","closedCallbacks","reconnectingCallbacks","reconnectedCallbacks","invocationId","receivedHandshakeResponse","connectionState","Disconnected","connectionStarted","cachedPingMessage","writeMessage","Ping","connectionId","baseUrl","set","Reconnecting","startPromise","startWithStateTransitions","e_1","Connecting","Debug","startInternal","Connected","handshakePromise","e_2","stopDuringStartError","undefined","handshakeResolver","handshakeRejecter","transferFormat","version","cleanupTimeout","resetTimeoutPeriod","resetKeepAliveInterval","cleanupPingTimer","stop","stopPromise","stopInternal","Disconnecting","reconnectDelayHandle","clearTimeout","completeClose","stream","methodName","args","promiseQueue","replaceStreamingParams","streams","streamIds","invocationDescriptor","createStreamInvocation","cancelInvocation","createCancelInvocation","sendWithProtocol","invocationEvent","Completion","launchStreams","sendPromise","createInvocation","invoke","on","newMethod","toLowerCase","off","handlers","removeIdx","onreconnecting","onreconnected","processHandshakeResponse","messages_1","parseMessages","Invocation","invokeClientMethod","StreamItem","Close","allowReconnect","responseMessage","pingServerHandle","setTimeout","features","inherentKeepAlive","timeoutHandle","serverTimeout","invocationMessage","cancelCallbacksWithError","reconnect","reconnectStartTime","previousReconnectAttempts","retryError","nextRetryDelay","e_4","getNextRetryDelay","previousRetryCount","elapsedMilliseconds","retryReason","nextRetryDelayInMilliseconds","nonblocking","_loop_1","streamId","createCompletionMessage","createStreamItemMessage","argument","isObservable","arg","StreamInvocation","CancelInvocation","DEFAULT_RETRY_DELAYS_IN_MILLISECONDS","DefaultReconnectPolicy","retryDelays","concat","retryContext","AbortController","isAborted","LongPollingTransport","pollAbort","running","connect","pollOptions","pollUrl","Binary","signal","getAccessToken","updateHeaderToken","closeError","receiving","poll","pollAborted","raiseOnClose","deleteOptions","logMessage","ServerSentEventsTransport","eventSourceConstructor","encodeURIComponent","opened","Text","eventSource","cookies","Cookie","onmessage","close","onopen","WebSocketTransport","webSocketConstructor","webSocket","replace","isNode","binaryType","_event","ErrorEvent","readyState","OPEN","wasClean","reason","WebSocketModule","EventSourceModule","HttpConnection","negotiateVersion","resolveUrl","WebSocket","EventSource","startInternalPromise","sendQueue","TransportSendQueue","transport","stopPromiseResolver","stopError","stopConnection","negotiateResponse","redirects","this_1","e_3","skipNegotiation","WebSockets","constructTransport","startTransport","accessToken_1","getNegotiationResponse","ProtocolVersion","accessToken","createTransport","negotiateUrl","resolveNegotiateUrl","connectionToken","createConnectUrl","requestedTransport","requestedTransferFormat","connectUrl","transportExceptions","transports","negotiate","transports_1","endpoint","transportOrError","ex_1","ex_2","isITransport","availableTransports","resolveTransportOrError","ServerSentEvents","LongPolling","actualTransport","transportMatches","transferFormats","ex","lastIndexOf","aTag","href","executing","sendBufferedData","PromiseSource","transportResult","sendLoopPromise","sendLoop","bufferData","error_1","concatBuffers","arrayBuffers","totalLength","reduce","offset","arrayBuffers_1","resolver","rejecter","JsonHubProtocol","hubMessages","parsedMessage","isInvocationMessage","isStreamItemMessage","isCompletionMessage","assertNotEmptyString","LogLevelNameMapping","trace","debug","information","warning","critical","none","None","HubConnectionBuilder","configureLogging","logging","mapping","parseLogLevel","withUrl","transportTypeOrOptions","httpConnectionOptions","withHubProtocol","withAutomaticReconnect","retryDelaysOrReconnectPolicy","isArray","build","signalr.LogLevel","begin","async","plane","planeid","className","center","display","toUpperCase","planeId","user","old_blocks","get_key","dynamic","list","destroy","create_each_block","get_context","old_indexes","new_blocks","new_lookup","deltas","child_ctx","will_move","did_move","first","new_block","old_block","new_key","old_key","iterations","descriptionText","currentPlane"],"mappings":"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"}